<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShopSmart - E-Commerce Recommendation System</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.0.2/marked.min.js"></script>
    <style>
        :root {
            --primary: #5D5CDE;
            --primary-dark: #4b4ab2;
            --primary-light: #7a79e0;
            --secondary: #6c63ff;
            --accent: #f50057;
            --accent-light: #ff4081;
            --bg-light: #ffffff;
            --bg-dark: #121212;
            --text-light: #333333;
            --text-dark: #f5f5f5;
            --card-light: #f9f9f9;
            --card-dark: #1e1e1e;
            --card-hover-light: #f0f0f0;
            --card-hover-dark: #2a2a2a;
            --input-light: #ffffff;
            --input-dark: #2c2c2c;
            --border-light: #e5e7eb;
            --border-dark: #383838;
            --success: #22c55e;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --font-main: 'Inter', sans-serif;
            
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: 300ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 500ms cubic-bezier(0.4, 0, 0.2, 1);
        }

        .dark {
            --primary: #7a79e0;
            --primary-dark: #9593ec;
            --primary-light: #8c8be5;
        }

        * {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            font-family: var(--font-main);
            transition: background-color 0.3s, color 0.3s;
            background-color: var(--bg-light);
            color: var(--text-light);
            overflow-x: hidden;
        }

        .dark body {
            background-color: var(--bg-dark);
            color: var(--text-dark);
        }

        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .active-page {
            display: block;
        }

        /* Card styles */
        .card {
            background-color: var(--card-light);
            border-radius: 0.75rem;
            box-shadow: var(--shadow-md);
            transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
        }

        .dark .card {
            background-color: var(--card-dark);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        /* Button styles */
        .btn-primary {
            background-color: var(--primary);
            color: white;
            transition: background-color 0.3s, transform 0.2s;
            font-weight: 500;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-1px);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background-color: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
            transition: background-color 0.3s, color 0.3s, transform 0.2s;
            font-weight: 500;
        }

        .btn-secondary:hover {
            background-color: var(--primary);
            color: white;
            transform: translateY(-1px);
        }

        .btn-secondary:active {
            transform: translateY(0);
        }

        /* Navigation styles */
        .nav-link {
            transition: color 0.3s;
            position: relative;
            font-weight: 500;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--primary);
            transition: width 0.3s;
        }

        .nav-link:hover::after,
        .nav-link.active::after {
            width: 100%;
        }

        /* Category pills */
        .category-pill {
            transition: background-color 0.3s, color 0.3s, transform 0.2s;
            font-weight: 500;
        }

        .category-pill:hover, 
        .category-pill.active {
            background-color: var(--primary);
            color: white;
            transform: translateY(-1px);
        }

        .category-pill:active {
            transform: translateY(0);
        }

        /* Product grid */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        @media (max-width: 1024px) {
            .product-grid {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .product-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
                gap: 1rem;
            }
        }

        /* Loader */
        .loader {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid var(--primary);
            width: 25px;
            height: 25px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
        }

        .dark .loader {
            border-color: rgba(0, 0, 0, 0.3);
            border-top-color: var(--primary);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 16px 24px;
            background-color: var(--card-dark);
            color: white;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            transform: translateY(100px);
            transition: transform 0.3s ease;
            max-width: 350px;
        }

        .toast.show {
            transform: translateY(0);
        }

        .dark .toast {
            background-color: var(--card-light);
            color: var(--text-light);
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .dark ::-webkit-scrollbar-track {
            background: #2a2a2a;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes slideInRight {
            from { transform: translateX(20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideInLeft {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        .scale-in {
            animation: scaleIn 0.5s ease;
        }

        .slide-in-right {
            animation: slideInRight 0.5s ease;
        }

        .slide-in-left {
            animation: slideInLeft 0.5s ease;
        }

        /* Product card animations */
        .product-card {
            transition: all 0.3s ease;
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        .product-image {
            transition: transform 0.5s ease;
        }

        /* Star ratings */
        .star-rating {
            color: #f59e0b;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            overflow-y: auto;
            backdrop-filter: blur(4px);
            transition: opacity 0.3s;
        }
        
        .modal-content {
            background-color: var(--bg-light);
            color: var(--text-light);
            margin: 5% auto;
            padding: 28px;
            border-radius: 12px;
            width: 90%;
            max-width: 700px;
            box-shadow: var(--shadow-xl);
            position: relative;
            animation: scaleIn 0.3s ease;
        }
        
        .dark .modal-content {
            background-color: var(--bg-dark);
            color: var(--text-dark);
        }
        
        .close-modal {
            position: absolute;
            top: 18px;
            right: 24px;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .dark .close-modal {
            color: var(--text-dark);
        }

        .close-modal:hover {
            opacity: 1;
        }

        /* Table styles */
        .table-container {
            overflow-x: auto;
            border-radius: 0.5rem;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }

        th, td {
            padding: 14px 18px;
            text-align: left;
        }

        thead {
            background-color: var(--primary);
        }

        th {
            color: white;
            font-weight: 500;
        }

        th:first-child {
            border-top-left-radius: 0.5rem;
        }

        th:last-child {
            border-top-right-radius: 0.5rem;
        }

        tr:last-child td:first-child {
            border-bottom-left-radius: 0.5rem;
        }

        tr:last-child td:last-child {
            border-bottom-right-radius: 0.5rem;
        }

        tbody tr {
            border-bottom: 1px solid var(--border-light);
            transition: background-color 0.2s;
        }

        .dark tbody tr {
            border-bottom: 1px solid var(--border-dark);
        }

        tbody tr:hover {
            background-color: rgba(93, 92, 222, 0.05);
        }

        /* Form elements */
        input, select, textarea {
            background-color: var(--input-light);
            color: var(--text-light);
            border: 1px solid var(--border-light);
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .dark input, .dark select, .dark textarea {
            background-color: var(--input-dark);
            color: var(--text-dark);
            border-color: var(--border-dark);
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(93, 92, 222, 0.2);
            outline: none;
        }

        /* Chart container */
        .chart-container {
            position: relative;
            min-height: 250px;
            margin-top: 1rem;
        }

        /* Profile page styles */
        .profile-header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 2rem;
            border-radius: 1rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
        }

        .tab-button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.3s;
        }

        .tab-button.active {
            background-color: var(--primary);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .profile-tab {
            display: none;
        }

        .profile-tab.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .stats-card {
            background-color: var(--card-light);
            padding: 1.5rem;
            border-radius: 1rem;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: var(--shadow-md);
        }

        .dark .stats-card {
            background-color: var(--card-dark);
        }

        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stats-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
        }

        /* Avatar upload */
        .avatar-upload {
            position: relative;
            width: 150px;
            margin: 0 auto;
        }

        .avatar-upload .avatar-edit {
            position: absolute;
            right: 5px;
            bottom: 5px;
            z-index: 1;
        }

        .avatar-upload .avatar-edit input {
            display: none;
        }

        .avatar-upload .avatar-edit label {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 34px;
            height: 34px;
            border-radius: 50%;
            background: var(--primary);
            border: 1px solid transparent;
            cursor: pointer;
            color: white;
            box-shadow: var(--shadow-md);
            transition: background-color 0.2s;
        }

        .avatar-upload .avatar-edit label:hover {
            background: var(--primary-dark);
        }

        .avatar-upload .avatar-preview {
            width: 150px;
            height: 150px;
            position: relative;
            border-radius: 50%;
            overflow: hidden;
            border: 3px solid var(--primary);
            box-shadow: var(--shadow-md);
        }

        .avatar-upload .avatar-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Order card styles */
        .order-card {
            border-left: 4px solid var(--primary);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .order-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .order-status {
            padding: 0.35rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .status-delivered {
            background-color: rgba(34, 197, 94, 0.2);
            color: rgb(34, 197, 94);
        }

        .status-shipped {
            background-color: rgba(59, 130, 246, 0.2);
            color: rgb(59, 130, 246);
        }

        .status-processing {
            background-color: rgba(249, 115, 22, 0.2);
            color: rgb(249, 115, 22);
        }

        .status-pending {
            background-color: rgba(59, 130, 246, 0.2);
            color: rgb(59, 130, 246);
        }

        /* Toggle switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:focus + .slider {
            box-shadow: 0 0 1px var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .slider.round {
            border-radius: 24px;
        }

        .slider.round:before {
            border-radius: 50%;
        }

        /* Skeleton loading */
        .skeleton {
            background: linear-gradient(90deg, var(--card-light) 25%, var(--card-hover-light) 50%, var(--card-light) 75%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s infinite;
        }

        .dark .skeleton {
            background: linear-gradient(90deg, var(--card-dark) 25%, var(--card-hover-dark) 50%, var(--card-dark) 75%);
            background-size: 200% 100%;
        }

        @keyframes skeleton-loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }

        /* Badges */
        .badge {
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .badge-primary {
            background-color: rgba(93, 92, 222, 0.2);
            color: var(--primary);
        }

        .badge-success {
            background-color: rgba(34, 197, 94, 0.2);
            color: var(--success);
        }

        .badge-warning {
            background-color: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .badge-error {
            background-color: rgba(239, 68, 68, 0.2);
            color: var(--error);
        }

        /* Price range slider */
        .price-slider {
            width: 100%;
            height: 5px;
            background: var(--border-light);
            border-radius: 5px;
        }

        .dark .price-slider {
            background: var(--border-dark);
        }

        .price-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
        }

        .price-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
        }

        /* Footer */
        footer {
            margin-top: 3rem;
            background-color: var(--card-light);
            border-top: 1px solid var(--border-light);
        }

        .dark footer {
            background-color: var(--card-dark);
            border-top: 1px solid var(--border-dark);
        }

        /* Enhanced product cards */
        .enhanced-card {
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
        }

        .enhanced-card::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 0.75rem;
            padding: 2px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .enhanced-card:hover::before {
            opacity: 1;
        }

        /* Image overlays */
        .hover-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            opacity: 0;
            transition: opacity 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
        }

        .product-card:hover .hover-overlay {
            opacity: 1;
        }

        /* Hero section animations */
        .hero-shape {
            position: absolute;
            top: 0;
            right: 0;
            width: 400px;
            height: 400px;
            background: linear-gradient(45deg, var(--primary-light), var(--secondary));
            border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
            animation: morph 8s ease-in-out infinite;
            opacity: 0.3;
            z-index: 0;
        }

        @keyframes morph {
            0% {
                border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
            }
            50% {
                border-radius: 30% 60% 70% 40% / 50% 60% 30% 60%;
            }
            100% {
                border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
            }
        }

        /* Recommendation badge */
        .recommendation-tag {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background: var(--accent);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            z-index: 10;
            box-shadow: var(--shadow-md);
            transform: rotate(-5deg);
        }

        /* Modern input with floating labels */
        .form-group {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-light);
            border-radius: 0.5rem;
            background-color: var(--input-light);
            transition: border-color 0.2s, box-shadow 0.2s;
            font-size: 1rem;
        }

        .dark .form-input {
            border-color: var(--border-dark);
            background-color: var(--input-dark);
        }

        .form-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(93, 92, 222, 0.2);
            outline: none;
        }

        .form-label {
            position: absolute;
            left: 1rem;
            top: 0.75rem;
            padding: 0 0.25rem;
            color: var(--text-light);
            opacity: 0.7;
            transition: all 0.2s;
            pointer-events: none;
        }

        .dark .form-label {
            color: var(--text-dark);
        }

        .form-input:focus ~ .form-label,
        .form-input:not(:placeholder-shown) ~ .form-label {
            top: -0.5rem;
            font-size: 0.75rem;
            left: 0.75rem;
            background-color: var(--input-light);
            padding: 0 0.25rem;
            color: var(--primary);
            opacity: 1;
        }

        .dark .form-input:focus ~ .form-label,
        .dark .form-input:not(:placeholder-shown) ~ .form-label {
            background-color: var(--input-dark);
        }

        /* Better mobile dropdown */
        .mobile-dropdown {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .mobile-dropdown.show {
            max-height: 300px;
        }

        /* Custom radio buttons */
        .custom-radio {
            display: inline-block;
            position: relative;
            padding-left: 2rem;
            cursor: pointer;
            font-size: 1rem;
            user-select: none;
            margin-right: 1rem;
        }

        .custom-radio input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .radio-mark {
            position: absolute;
            top: 2px;
            left: 0;
            height: 18px;
            width: 18px;
            background-color: var(--input-light);
            border: 2px solid var(--border-light);
            border-radius: 50%;
        }

        .dark .radio-mark {
            background-color: var(--input-dark);
            border-color: var(--border-dark);
        }

        .custom-radio:hover input ~ .radio-mark {
            border-color: var(--primary);
        }

        .custom-radio input:checked ~ .radio-mark {
            background-color: var(--primary);
            border-color: var(--primary);
        }

        .radio-mark:after {
            content: "";
            position: absolute;
            display: none;
        }

        .custom-radio input:checked ~ .radio-mark:after {
            display: block;
        }

        .custom-radio .radio-mark:after {
            top: 4px;
            left: 4px;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: white;
        }

        /* Pulse animation for status indicators */
        @keyframes pulse {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(93, 92, 222, 0.4);
            }
            
            70% {
                transform: scale(1);
                box-shadow: 0 0 0 10px rgba(93, 92, 222, 0);
            }
            
            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(93, 92, 222, 0);
            }
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 0.5rem;
        }

        .status-online {
            background-color: var(--success);
            animation: pulse 2s infinite;
        }

        .status-offline {
            background-color: var(--error);
        }

        .status-away {
            background-color: var(--warning);
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="fixed top-0 w-full bg-white dark:bg-gray-800 shadow-md z-50 transition-colors duration-300">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-2">
                    <i class="fas fa-shopping-cart text-2xl text-primary"></i>
                    <a href="#" class="text-xl font-bold text-gray-800 dark:text-white" onclick="navigateTo('home')">ShopSmart</a>
                </div>
                
                <div class="hidden md:flex space-x-8">
                    <a href="#" class="nav-link text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary" onclick="navigateTo('home')">Home</a>
                    <a href="#" class="nav-link text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary" onclick="navigateTo('recommendations')">For You</a>
                    <a href="#" class="nav-link text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary" onclick="navigateTo('categories')">Categories</a>
                    <a href="#" class="nav-link text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary" onclick="navigateTo('about')">About</a>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <input id="searchInput" type="text" placeholder="Search products..." class="py-2 pl-4 pr-10 rounded-full border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white text-base w-40 md:w-auto">
                        <button onclick="searchProducts()" class="absolute right-0 top-0 mt-2 mr-3 text-gray-500 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    
                    <button id="darkModeToggle" class="w-10 h-10 rounded-full flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i class="fas fa-moon dark:hidden"></i>
                        <i class="fas fa-sun hidden dark:block"></i>
                    </button>
                    
                    <div id="userSection">
                        <button onclick="navigateTo('login')" class="btn-primary py-2 px-4 rounded-full text-base transition-all duration-200">Login</button>
                    </div>
                    
                    <button id="mobileMenuBtn" class="md:hidden text-gray-600 dark:text-gray-300 focus:outline-none p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors duration-200">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
            
            <!-- Mobile Menu -->
            <div id="mobileMenu" class="md:hidden mobile-dropdown overflow-hidden transition-all duration-300">
                <div class="py-2 space-y-2">
                    <a href="#" class="block py-2 px-4 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors duration-200" onclick="navigateTo('home'); toggleMobileMenu()">Home</a>
                    <a href="#" class="block py-2 px-4 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors duration-200" onclick="navigateTo('recommendations'); toggleMobileMenu()">For You</a>
                    <a href="#" class="block py-2 px-4 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors duration-200" onclick="navigateTo('categories'); toggleMobileMenu()">Categories</a>
                    <a href="#" class="block py-2 px-4 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors duration-200" onclick="navigateTo('about'); toggleMobileMenu()">About</a>
                    <div id="mobileUserLinks">
                        <a href="#" class="block py-2 px-4 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors duration-200" onclick="navigateTo('profile'); toggleMobileMenu()">My Profile</a>
                        <a href="#" class="block py-2 px-4 text-red-500 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors duration-200" onclick="logout(); toggleMobileMenu()">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 pt-24 pb-12">
        <!-- Home Page -->
        <div id="homePage" class="page active-page">
            <section class="mb-10 relative overflow-hidden">
                <div class="hero-shape"></div>
                <div class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl p-8 md:p-12 text-white relative z-10 overflow-hidden">
                    <div class="max-w-2xl">
                        <span class="px-4 py-1 rounded-full bg-white bg-opacity-20 text-sm font-medium inline-block mb-4">Smart Shopping</span>
                        <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold mb-4 leading-tight">Discover Products Made <span class="text-yellow-300">For You</span></h1>
                        <p class="text-lg md:text-xl mb-8 text-white text-opacity-90">Personalized recommendations based on your browsing history and preferences.</p>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <button onclick="navigateTo('recommendations')" class="bg-white text-indigo-600 py-3 px-8 rounded-full font-bold hover:bg-gray-100 transition duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1">View Recommendations</button>
                            <button onclick="navigateTo('categories')" class="bg-transparent border-2 border-white text-white py-3 px-8 rounded-full font-bold hover:bg-white hover:bg-opacity-10 transition duration-300">Browse Categories</button>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="mb-12">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
                    <div>
                        <h2 class="text-2xl font-bold mb-2">Popular Products</h2>
                        <p class="text-gray-600 dark:text-gray-400">Discover our most sought-after items</p>
                    </div>
                    <div class="flex items-center">
                        <button id="viewToggleBtn" onclick="toggleViewMode()" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary flex items-center py-2 px-4 rounded-md border border-gray-300 dark:border-gray-600 transition-colors duration-200">
                            <i id="viewIcon" class="fas fa-th-large mr-2"></i>
                            <span id="viewMode">Grid View</span>
                        </button>
                    </div>
                </div>
                
                <div class="categories-container overflow-x-auto pb-6 -mx-4 px-4">
                    <div class="flex space-x-3 min-w-max">
                        <button class="category-pill py-2 px-6 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 active hover:shadow-md transition-all duration-200" onclick="filterByCategory('all')">All Products</button>
                        <button class="category-pill py-2 px-6 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:shadow-md transition-all duration-200" onclick="filterByCategory('electronics')">Electronics</button>
                        <button class="category-pill py-2 px-6 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:shadow-md transition-all duration-200" onclick="filterByCategory('clothing')">Clothing</button>
                        <button class="category-pill py-2 px-6 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:shadow-md transition-all duration-200" onclick="filterByCategory('home')">Home</button>
                        <button class="category-pill py-2 px-6 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:shadow-md transition-all duration-200" onclick="filterByCategory('books')">Books</button>
                        <button class="category-pill py-2 px-6 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:shadow-md transition-all duration-200" onclick="filterByCategory('beauty')">Beauty</button>
                        <button class="category-pill py-2 px-6 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:shadow-md transition-all duration-200" onclick="filterByCategory('sports')">Sports</button>
                    </div>
                </div>
                
                <div id="filterControls" class="card p-6 mb-8">
                    <h3 class="font-semibold text-lg mb-4">Filter & Sort</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Price Range</label>
                            <div class="flex items-center space-x-3">
                                <div class="relative">
                                    <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">$</span>
                                    <input type="number" id="minPrice" placeholder="Min" class="w-full py-2 pl-8 pr-3 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-base">
                                </div>
                                <span class="text-gray-500">-</span>
                                <div class="relative">
                                    <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">$</span>
                                    <input type="number" id="maxPrice" placeholder="Max" class="w-full py-2 pl-8 pr-3 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-base">
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Sort By</label>
                            <select id="sortOption" onchange="sortProducts()" class="w-full py-2 px-3 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-base">
                                <option value="popularity">Popularity</option>
                                <option value="price_low">Price: Low to High</option>
                                <option value="price_high">Price: High to Low</option>
                                <option value="rating">Highest Rated</option>
                                <option value="newest">Newest Arrivals</option>
                            </select>
                        </div>
                        
                        <div class="flex items-end">
                            <button onclick="applyFilters()" class="btn-primary py-2 px-6 rounded-md text-base w-full flex items-center justify-center">
                                <i class="fas fa-filter mr-2"></i> Apply Filters
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="productsContainer" class="product-grid">
                    <!-- Products will be loaded here -->
                    <div class="col-span-full flex flex-col items-center justify-center py-12">
                        <div class="loader"></div>
                        <p class="mt-4 text-gray-600 dark:text-gray-400">Loading products...</p>
                    </div>
                </div>
                
                <div class="flex justify-center mt-8">
                    <button id="loadMoreBtn" onclick="loadMoreProducts()" class="btn-primary py-3 px-8 rounded-md text-base font-medium flex items-center space-x-2 shadow-md hover:shadow-lg transition-all duration-300 hidden">
                        <span>Load More Products</span>
                        <i class="fas fa-arrow-down ml-2"></i>
                    </button>
                </div>
            </section>
            
            <section class="mb-12">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">Recently Viewed</h2>
                    <a href="#" onclick="navigateTo('recommendations')" class="text-primary hover:text-primary-dark flex items-center">
                        <span>See All</span>
                        <i class="fas fa-arrow-right ml-2"></i>
                    </a>
                </div>
                <div id="recentlyViewedContainer" class="product-grid">
                    <!-- Recently viewed products will be loaded here -->
                    <div class="col-span-full text-center py-8">
                        <p class="text-gray-600 dark:text-gray-400">No recently viewed products</p>
                    </div>
                </div>
            </section>

            <section class="mb-12">
                <div class="bg-gray-100 dark:bg-gray-800 rounded-xl p-8 grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                    <div>
                        <h2 class="text-2xl font-bold mb-4">Smart Shopping Assistant</h2>
                        <p class="text-gray-600 dark:text-gray-400 mb-6">Get personalized shopping advice with our AI assistant. Just tell us what you're looking for!</p>
                        <button onclick="openShoppingAssistant()" class="btn-primary py-3 px-6 rounded-md flex items-center space-x-2">
                            <i class="fas fa-robot"></i>
                            <span>Chat with Assistant</span>
                        </button>
                    </div>
                    <div class="hidden md:flex justify-center">
                        <img src="static/images/5.jpg" alt="AI Shopping Assistant" class="rounded-lg shadow-lg max-w-full h-auto">
                    </div>
                </div>
            </section>
        </div>

        <!-- Recommendations Page -->
        <div id="recommendationsPage" class="page">
            <section class="mb-10">
                <div class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-xl p-8 md:p-10 relative overflow-hidden">
                    <div class="hero-shape"></div>
                    <div class="relative z-10 max-w-2xl">
                        <h1 class="text-3xl md:text-4xl font-bold mb-4">Your Personalized Recommendations</h1>
                        <p class="text-lg mb-6 text-white text-opacity-90">Tailored products based on your preferences and browsing history.</p>
                        
                        <div class="flex items-center">
                            <p id="recommendationStatus" class="text-sm text-white text-opacity-80 mr-4"><i class="fas fa-sync-alt mr-2"></i> Last updated: Just now</p>
                            <button id="refreshRecommendationsBtn" onclick="refreshRecommendations()" class="bg-white text-indigo-600 py-2 px-5 rounded-full font-medium hover:bg-opacity-90 transition duration-300 shadow-md flex items-center">
                                <i class="fas fa-redo-alt mr-2"></i> Refresh
                            </button>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="mb-12">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold mb-1">Just For You</h2>
                        <p class="text-gray-600 dark:text-gray-400">Products we think you'll love based on your activity</p>
                    </div>
                </div>
                
                <div id="personalizedRecommendations" class="product-grid">
                    <!-- Personalized recommendations will be loaded here -->
                    <div class="col-span-full flex flex-col items-center justify-center py-12">
                        <div class="loader"></div>
                        <p class="mt-4 text-gray-600 dark:text-gray-400">Generating personalized recommendations...</p>
                    </div>
                </div>
            </section>
            
            <section class="mb-12">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold mb-1">Because You Viewed</h2>
                        <p class="text-gray-600 dark:text-gray-400">Similar products to items you've recently viewed</p>
                    </div>
                </div>
                <div id="similarProductsContainer" class="product-grid">
                    <!-- Similar products will be loaded here -->
                    <div class="col-span-full flex flex-col items-center justify-center py-12">
                        <div class="loader"></div>
                        <p class="mt-4 text-gray-600 dark:text-gray-400">Finding similar products...</p>
                    </div>
                </div>
            </section>
            
            <section class="mb-12">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold mb-1">Popular Among Similar Users</h2>
                        <p class="text-gray-600 dark:text-gray-400">Products that users with similar tastes have purchased</p>
                    </div>
                </div>
                <div id="collaborativeRecommendations" class="product-grid">
                    <!-- Collaborative recommendations will be loaded here -->
                    <div class="col-span-full flex flex-col items-center justify-center py-12">
                        <div class="loader"></div>
                        <p class="mt-4 text-gray-600 dark:text-gray-400">Finding popular products among similar users...</p>
                    </div>
                </div>
            </section>

            <section class="mb-12">
                <div class="card p-8">
                    <div class="flex flex-col md:flex-row md:items-center gap-6">
                        <div class="md:w-2/3">
                            <h2 class="text-2xl font-bold mb-4">Improve Your Recommendations</h2>
                            <p class="text-gray-600 dark:text-gray-400 mb-4">The more you browse, the better our recommendations become. Complete your preference profile to get even more personalized suggestions.</p>
                            <button onclick="navigateTo('profile')" class="btn-primary py-2 px-6 rounded-md">Update Preferences</button>
                        </div>
                        <div class="md:w-1/3 flex justify-center">
                            <div class="rounded-full bg-indigo-100 dark:bg-indigo-900 p-5">
                                <i class="fas fa-lightbulb text-6xl text-indigo-500 dark:text-indigo-400"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Categories Page -->
        <div id="categoriesPage" class="page">
            <section class="mb-10">
                <div class="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl p-8 text-white relative overflow-hidden">
                    <div class="hero-shape"></div>
                    <div class="relative z-10 max-w-2xl">
                        <h1 class="text-3xl md:text-4xl font-bold mb-4">Shop by Category</h1>
                        <p class="text-lg">Browse our full collection of products organized by category.</p>
                    </div>
                </div>
            </section>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="enhanced-card overflow-hidden">
                    <div class="h-40 bg-gradient-to-r from-blue-500 to-blue-600 flex items-center justify-center relative">
                        <i class="fas fa-laptop text-6xl text-white"></i>
                        <div class="absolute bottom-0 left-0 w-full h-1/2 bg-gradient-to-t from-blue-600 to-transparent"></div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">Electronics</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4">Latest gadgets and devices for tech enthusiasts</p>
                        <button onclick="filterByCategory('electronics'); navigateTo('home');" class="btn-primary py-2 px-4 rounded-md w-full flex items-center justify-center">
                            <span>Browse Electronics</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <div class="enhanced-card overflow-hidden">
                    <div class="h-40 bg-gradient-to-r from-purple-500 to-purple-600 flex items-center justify-center relative">
                        <i class="fas fa-tshirt text-6xl text-white"></i>
                        <div class="absolute bottom-0 left-0 w-full h-1/2 bg-gradient-to-t from-purple-600 to-transparent"></div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">Clothing</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4">Trendy fashion for all occasions and seasons</p>
                        <button onclick="filterByCategory('clothing'); navigateTo('home');" class="btn-primary py-2 px-4 rounded-md w-full flex items-center justify-center">
                            <span>Browse Clothing</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <div class="enhanced-card overflow-hidden">
                    <div class="h-40 bg-gradient-to-r from-green-500 to-green-600 flex items-center justify-center relative">
                        <i class="fas fa-home text-6xl text-white"></i>
                        <div class="absolute bottom-0 left-0 w-full h-1/2 bg-gradient-to-t from-green-600 to-transparent"></div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">Home & Kitchen</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4">Everything you need to make your house a home</p>
                        <button onclick="filterByCategory('home'); navigateTo('home');" class="btn-primary py-2 px-4 rounded-md w-full flex items-center justify-center">
                            <span>Browse Home</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <div class="enhanced-card overflow-hidden">
                    <div class="h-40 bg-gradient-to-r from-yellow-500 to-yellow-600 flex items-center justify-center relative">
                        <i class="fas fa-book text-6xl text-white"></i>
                        <div class="absolute bottom-0 left-0 w-full h-1/2 bg-gradient-to-t from-yellow-600 to-transparent"></div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">Books</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4">Bestsellers, classics, and hidden gems for book lovers</p>
                        <button onclick="filterByCategory('books'); navigateTo('home');" class="btn-primary py-2 px-4 rounded-md w-full flex items-center justify-center">
                            <span>Browse Books</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <div class="enhanced-card overflow-hidden">
                    <div class="h-40 bg-gradient-to-r from-pink-500 to-pink-600 flex items-center justify-center relative">
                        <i class="fas fa-spa text-6xl text-white"></i>
                        <div class="absolute bottom-0 left-0 w-full h-1/2 bg-gradient-to-t from-pink-600 to-transparent"></div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">Beauty & Personal Care</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4">Premium beauty products and essentials</p>
                        <button onclick="filterByCategory('beauty'); navigateTo('home');" class="btn-primary py-2 px-4 rounded-md w-full flex items-center justify-center">
                            <span>Browse Beauty</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <div class="enhanced-card overflow-hidden">
                    <div class="h-40 bg-gradient-to-r from-red-500 to-red-600 flex items-center justify-center relative">
                        <i class="fas fa-running text-6xl text-white"></i>
                        <div class="absolute bottom-0 left-0 w-full h-1/2 bg-gradient-to-t from-red-600 to-transparent"></div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold mb-2">Sports & Outdoors</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4">Equipment and apparel for active lifestyles</p>
                        <button onclick="filterByCategory('sports'); navigateTo('home');" class="btn-primary py-2 px-4 rounded-md w-full flex items-center justify-center">
                            <span>Browse Sports</span>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>

            <section class="mt-12">
                <h2 class="text-2xl font-bold mb-6">Trending Categories</h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="card p-4 text-center">
                        <div class="badge badge-primary inline-block mb-3">+24% this week</div>
                        <h3 class="font-semibold">Wireless Earbuds</h3>
                    </div>
                    <div class="card p-4 text-center">
                        <div class="badge badge-primary inline-block mb-3">+18% this week</div>
                        <h3 class="font-semibold">Smart Watches</h3>
                    </div>
                    <div class="card p-4 text-center">
                        <div class="badge badge-primary inline-block mb-3">+15% this week</div>
                        <h3 class="font-semibold">Home Office</h3>
                    </div>
                    <div class="card p-4 text-center">
                        <div class="badge badge-primary inline-block mb-3">+12% this week</div>
                        <h3 class="font-semibold">Fitness Gear</h3>
                    </div>
                </div>
            </section>
        </div>

        <!-- About Page -->
        <div id="aboutPage" class="page">
            <section class="mb-10">
                <div class="bg-gradient-to-r from-purple-600 to-indigo-600 rounded-xl p-8 text-white relative overflow-hidden">
                    <div class="hero-shape"></div>
                    <div class="relative z-10 max-w-2xl">
                        <h1 class="text-3xl md:text-4xl font-bold mb-4">About ShopSmart</h1>
                        <p class="text-lg">Learn about our advanced recommendation system and how we help you find products you'll love.</p>
                    </div>
                </div>
            </section>
            
            <div class="card p-8 mb-8">
                <h2 class="text-2xl font-bold mb-6">Our Recommendation System</h2>
                <p class="text-gray-600 dark:text-gray-400 mb-6 text-lg">
                    ShopSmart uses an advanced hybrid recommendation system that combines collaborative filtering and content-based approaches to provide personalized product suggestions tailored to your unique preferences.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
                    <div class="bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg">
                        <div class="rounded-full bg-blue-100 dark:bg-blue-800 w-14 h-14 flex items-center justify-center mb-4">
                            <i class="fas fa-users text-2xl text-blue-600 dark:text-blue-300"></i>
                        </div>
                        <h3 class="font-bold text-xl mb-3">Collaborative Filtering</h3>
                        <p class="text-gray-600 dark:text-gray-400">Our system identifies patterns among similar users to recommend products that others with similar tastes have enjoyed. This helps you discover new items that match your preferences.</p>
                    </div>
                    <div class="bg-purple-50 dark:bg-purple-900/20 p-6 rounded-lg">
                        <div class="rounded-full bg-purple-100 dark:bg-purple-800 w-14 h-14 flex items-center justify-center mb-4">
                            <i class="fas fa-tags text-2xl text-purple-600 dark:text-purple-300"></i>
                        </div>
                        <h3 class="font-bold text-xl mb-3">Content-Based Filtering</h3>
                        <p class="text-gray-600 dark:text-gray-400">By analyzing product attributes and your browsing history, we can recommend items with characteristics similar to those you've shown interest in, ensuring relevant suggestions.</p>
                    </div>
                </div>
            </div>
            
            <div class="card p-8 mb-8">
                <h2 class="text-2xl font-bold mb-6">Project Information</h2>
                <div class="flex flex-col md:flex-row gap-8">
                    <div class="md:w-2/3">
                        <p class="text-gray-600 dark:text-gray-400 mb-4 leading-relaxed">
                            This e-commerce recommendation system was developed as part of a Bachelor of Science in Computer Science project at Multimedia University of Kenya by Kiplagat Cosmas under the supervision of Mr. Muturi.
                        </p>
                        <p class="text-gray-600 dark:text-gray-400 leading-relaxed">
                            The project aims to enhance user experience through personalized product recommendations using advanced machine learning algorithms. By analyzing user behavior and preferences, the system can suggest products that users are more likely to be interested in, improving discovery and satisfaction.
                        </p>
                    </div>
                    <div class="md:w-1/3 flex justify-center items-center">
                        <img src="static/images/logo.jpg" alt="University Logo" class="rounded-lg shadow-lg max-w-full h-auto">
                    </div>
                </div>
            </div>
            
            <div class="card p-8">
                <h2 class="text-2xl font-bold mb-6">Technology Stack</h2>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-4">
                    <div class="bg-gray-100 dark:bg-gray-700 p-6 rounded-lg text-center hover:shadow-md transition duration-300 transform hover:-translate-y-1">
                        <i class="fab fa-python text-5xl mb-4 text-blue-500"></i>
                        <h3 class="font-bold">Python</h3>
                        <p class="text-sm text-gray-600 dark:text-gray-400">Backend processing and ML algorithms</p>
                    </div>
                    <div class="bg-gray-100 dark:bg-gray-700 p-6 rounded-lg text-center hover:shadow-md transition duration-300 transform hover:-translate-y-1">
                        <i class="fab fa-js text-5xl mb-4 text-yellow-500"></i>
                        <h3 class="font-bold">JavaScript</h3>
                        <p class="text-sm text-gray-600 dark:text-gray-400">Frontend interactivity</p>
                    </div>
                    <div class="bg-gray-100 dark:bg-gray-700 p-6 rounded-lg text-center hover:shadow-md transition duration-300 transform hover:-translate-y-1">
                        <i class="fas fa-database text-5xl mb-4 text-green-500"></i>
                        <h3 class="font-bold">MySQL</h3>
                        <p class="text-sm text-gray-600 dark:text-gray-400">Database management</p>
                    </div>
                    <div class="bg-gray-100 dark:bg-gray-700 p-6 rounded-lg text-center hover:shadow-md transition duration-300 transform hover:-translate-y-1">
                        <i class="fab fa-html5 text-5xl mb-4 text-red-500"></i>
                        <h3 class="font-bold">HTML/CSS</h3>
                        <p class="text-sm text-gray-600 dark:text-gray-400">Frontend structure and styling</p>
                    </div>
                    <div class="bg-gray-100 dark:bg-gray-700 p-6 rounded-lg text-center hover:shadow-md transition duration-300 transform hover:-translate-y-1">
                        <i class="fas fa-flask text-5xl mb-4 text-purple-500"></i>
                        <h3 class="font-bold">Flask</h3>
                        <p class="text-sm text-gray-600 dark:text-gray-400">Web framework</p>
                    </div>
                    <div class="bg-gray-100 dark:bg-gray-700 p-6 rounded-lg text-center hover:shadow-md transition duration-300 transform hover:-translate-y-1">
                        <i class="fas fa-brain text-5xl mb-4 text-pink-500"></i>
                        <h3 class="font-bold">Machine Learning</h3>
                        <p class="text-sm text-gray-600 dark:text-gray-400">Recommendation algorithms</p>
                    </div>
                </div>

                <div class="mt-12">
                    <h3 class="text-xl font-bold mb-4">Our Machine Learning Pipeline</h3>
                    <div class="relative bg-gray-100 dark:bg-gray-700 p-6 rounded-lg">
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                            <div class="text-center">
                                <div class="h-20 flex items-center justify-center">
                                    <i class="fas fa-database text-3xl text-indigo-500"></i>
                                </div>
                                <h4 class="font-semibold">Data Collection</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">User behaviors and preferences</p>
                            </div>
                            
                            <div class="text-center relative">
                                <div class="hidden md:block absolute left-0 top-10 w-full h-0.5 bg-indigo-500 -z-10"></div>
                                <div class="h-20 flex items-center justify-center">
                                    <i class="fas fa-broom text-3xl text-indigo-500"></i>
                                </div>
                                <h4 class="font-semibold">Data Processing</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Cleaning and normalization</p>
                            </div>
                            
                            <div class="text-center relative">
                                <div class="hidden md:block absolute left-0 top-10 w-full h-0.5 bg-indigo-500 -z-10"></div>
                                <div class="h-20 flex items-center justify-center">
                                    <i class="fas fa-cogs text-3xl text-indigo-500"></i>
                                </div>
                                <h4 class="font-semibold">Algorithm Training</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Model development</p>
                            </div>
                            
                            <div class="text-center relative">
                                <div class="hidden md:block absolute left-0 top-10 w-full h-0.5 bg-indigo-500 -z-10"></div>
                                <div class="h-20 flex items-center justify-center">
                                    <i class="fas fa-check-double text-3xl text-indigo-500"></i>
                                </div>
                                <h4 class="font-semibold">Validation</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Testing recommendation quality</p>
                            </div>
                            
                            <div class="text-center relative">
                                <div class="hidden md:block absolute left-0 top-10 w-full h-0.5 bg-indigo-500 -z-10"></div>
                                <div class="h-20 flex items-center justify-center">
                                    <i class="fas fa-lightbulb text-3xl text-indigo-500"></i>
                                </div>
                                <h4 class="font-semibold">Recommendation</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Personalized suggestions</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Login Page -->
        <div id="loginPage" class="page">
            <div class="max-w-md mx-auto">
                <div class="card p-8">
                    <div class="text-center mb-8">
                        <div class="w-20 h-20 bg-primary rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-user-circle text-3xl text-white"></i>
                        </div>
                        <h1 class="text-2xl font-bold">Welcome Back</h1>
                        <p class="text-gray-600 dark:text-gray-400 mt-2">Sign in to your account to continue</p>
                    </div>
                    
                    <form id="loginForm" onsubmit="return handleLogin(event)" class="space-y-5">
                        <div class="form-group">
                            <input type="email" id="loginEmail" class="form-input" placeholder=" " required>
                            <label for="loginEmail" class="form-label">Email Address</label>
                        </div>
                        
                        <div class="form-group">
                            <input type="password" id="loginPassword" class="form-input" placeholder=" " required>
                            <label for="loginPassword" class="form-label">Password</label>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <input type="checkbox" id="remember" class="h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded">
                                <label for="remember" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">Remember me</label>
                            </div>
                            <a href="#" class="text-sm text-primary hover:text-primary-dark font-medium">Forgot password?</a>
                        </div>
                        
                        <button type="submit" class="w-full btn-primary py-3 rounded-md text-base font-medium">Sign In</button>
                    </form>

                    <div class="relative flex items-center justify-center my-6">
                        <div class="w-full border-t border-gray-300 dark:border-gray-700"></div>
                        <span class="px-3 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400 text-sm">or</span>
                        <div class="w-full border-t border-gray-300 dark:border-gray-700"></div>
                    </div>

                    
                    <div class="mt-8 text-center">
                        <p class="text-gray-600 dark:text-gray-400">Don't have an account? <a href="#" onclick="navigateTo('register')" class="text-primary hover:text-primary-dark font-medium">Create Account</a></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Register Page -->
        <div id="registerPage" class="page">
            <div class="max-w-md mx-auto">
                <div class="card p-8">
                    <div class="text-center mb-8">
                        <div class="w-20 h-20 bg-primary rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-user-plus text-3xl text-white"></i>
                        </div>
                        <h1 class="text-2xl font-bold">Create Your Account</h1>
                        <p class="text-gray-600 dark:text-gray-400 mt-2">Join ShopSmart to get personalized recommendations</p>
                    </div>
                    
                    <form id="registerForm" onsubmit="return handleRegister(event)" class="space-y-5">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                            <div class="form-group">
                                <input type="text" id="firstName" class="form-input" placeholder=" " required>
                                <label for="firstName" class="form-label">First Name</label>
                            </div>
                            
                            <div class="form-group">
                                <input type="text" id="lastName" class="form-input" placeholder=" " required>
                                <label for="lastName" class="form-label">Last Name</label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <input type="email" id="registerEmail" class="form-input" placeholder=" " required>
                            <label for="registerEmail" class="form-label">Email Address</label>
                        </div>
                        
                        <div class="form-group">
                            <input type="password" id="registerPassword" class="form-input" placeholder=" " required>
                            <label for="registerPassword" class="form-label">Password</label>
                            <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Password must be at least 8 characters long with at least one uppercase letter, one number, and one special character.</p>
                        </div>
                        
                        <div class="form-group">
                            <input type="password" id="confirmPassword" class="form-input" placeholder=" " required>
                            <label for="confirmPassword" class="form-label">Confirm Password</label>
                        </div>
                        
                        <div class="flex items-center">
                            <input type="checkbox" id="terms" class="h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded" required>
                            <label for="terms" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">I agree to the <a href="#" class="text-primary hover:text-primary-dark">Terms of Service</a> and <a href="#" class="text-primary hover:text-primary-dark">Privacy Policy</a></label>
                        </div>
                        
                        <button type="submit" class="w-full btn-primary py-3 rounded-md text-base font-medium">Create Account</button>
                    </form>
                    
                    <div class="mt-8 text-center">
                        <p class="text-gray-600 dark:text-gray-400">Already have an account? <a href="#" onclick="navigateTo('login')" class="text-primary hover:text-primary-dark font-medium">Sign in</a></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- User Profile Page -->
        <div id="profilePage" class="page">
            <div class="profile-header mb-8 rounded-xl">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div class="flex flex-col md:flex-row md:items-center">
                        <div class="avatar-upload mb-6 md:mb-0 md:mr-8">
                            <div class="avatar-edit">
                                <input type="file" id="avatarUpload" accept=".png, .jpg, .jpeg" />
                                <label for="avatarUpload"><i class="fas fa-camera"></i></label>
                            </div>
                            <div class="avatar-preview">
                                <img id="userAvatar" src="static/images/users/default.jpg" alt="User Avatar">
                            </div>
                        </div>
                        <div>
                            <h1 id="profileUserName" class="text-2xl md:text-3xl font-bold mb-1">John Smith</h1>
                            <p id="profileUserEmail" class="text-white text-opacity-80 mb-3">john.smith@example.com</p>
                            <p class="flex items-center">
                                <span class="status-indicator status-online"></span>
                                <span>Online</span>
                            </p>
                            <p class="mt-2"><span id="profileMemberSince" class="bg-white bg-opacity-20 text-white px-3 py-1 rounded-full text-sm">Member since May 2022</span></p>
                        </div>
                    </div>
                    <div class="mt-6 md:mt-0">
                        <button onclick="editProfileInfo()" class="bg-white text-primary py-2 px-5 rounded-md flex items-center shadow-md hover:shadow-lg transition-all duration-200">
                            <i class="fas fa-edit mr-2"></i> Edit Profile
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Profile Tabs -->
            <div class="mb-8">
                <div class="flex flex-wrap gap-2 border-b border-gray-200 dark:border-gray-700 mb-6 pb-2">
                    <button id="overviewTabBtn" onclick="showProfileTab('overview')" class="tab-button active transition-all duration-200">
                        <i class="fas fa-user mr-2"></i> Overview
                    </button>
                    <button id="ordersTabBtn" onclick="showProfileTab('orders')" class="tab-button transition-all duration-200">
                        <i class="fas fa-shopping-bag mr-2"></i> Orders
                    </button>
                    <button id="wishlistTabBtn" onclick="showProfileTab('wishlist')" class="tab-button transition-all duration-200">
                        <i class="fas fa-heart mr-2"></i> Wishlist
                    </button>
                    <button id="settingsTabBtn" onclick="showProfileTab('settings')" class="tab-button transition-all duration-200">
                        <i class="fas fa-cog mr-2"></i> Settings
                    </button>
                </div>
                
                <!-- Overview Tab -->
                <div id="overviewTab" class="profile-tab active">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="stats-card">
                            <div class="stats-icon bg-blue-100 dark:bg-blue-900 text-blue-500">
                                <i class="fas fa-shopping-bag text-2xl"></i>
                            </div>
                            <h4 class="text-2xl font-bold mb-1" id="statsOrdersCount">12</h4>
                            <p class="text-gray-600 dark:text-gray-400">Orders Placed</p>
                        </div>
                        
                        <div class="stats-card">
                            <div class="stats-icon bg-green-100 dark:bg-green-900 text-green-500">
                                <i class="fas fa-dollar-sign text-2xl"></i>
                            </div>
                            <h4 class="text-2xl font-bold mb-1" id="statsTotalSpent">$1,245.80</h4>
                            <p class="text-gray-600 dark:text-gray-400">Total Spent</p>
                        </div>
                        
                        <div class="stats-card">
                            <div class="stats-icon bg-purple-100 dark:bg-purple-900 text-purple-500">
                                <i class="fas fa-heart text-2xl"></i>
                            </div>
                            <h4 class="text-2xl font-bold mb-1" id="statsWishlistCount">8</h4>
                            <p class="text-gray-600 dark:text-gray-400">Wishlist Items</p>
                        </div>
                    </div>
                    
                    <div class="card p-6 mb-8">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold">Recent Orders</h3>
                            <button onclick="showProfileTab('orders')" class="text-primary hover:text-primary-dark flex items-center">
                                <span>View All</span>
                                <i class="fas fa-arrow-right ml-2"></i>
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                    <tr>
                                        <th>Order ID</th>
                                        <th>Date</th>
                                        <th>Items</th>
                                        <th>Total</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="recentOrdersTable">
                                    <!-- Orders will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold mb-6">Recommendation Insights</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div>
                                <h4 class="font-bold mb-4">Your Top Categories</h4>
                                <div class="space-y-4">
                                    <div>
                                        <div class="flex justify-between mb-2">
                                            <span class="text-gray-600 dark:text-gray-400">Electronics</span>
                                            <span class="text-gray-600 dark:text-gray-400">45%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden">
                                            <div class="bg-primary h-2.5 rounded-full" style="width: 45%"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-2">
                                            <span class="text-gray-600 dark:text-gray-400">Clothing</span>
                                            <span class="text-gray-600 dark:text-gray-400">30%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden">
                                            <div class="bg-primary h-2.5 rounded-full" style="width: 30%"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-2">
                                            <span class="text-gray-600 dark:text-gray-400">Books</span>
                                            <span class="text-gray-600 dark:text-gray-400">15%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden">
                                            <div class="bg-primary h-2.5 rounded-full" style="width: 15%"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-2">
                                            <span class="text-gray-600 dark:text-gray-400">Home</span>
                                            <span class="text-gray-600 dark:text-gray-400">10%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden">
                                            <div class="bg-primary h-2.5 rounded-full" style="width: 10%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-bold mb-4">Recommendation Quality</h4>
                                <div class="chart-container">
                                    <canvas id="recommendationQualityChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Orders Tab -->
                <div id="ordersTab" class="profile-tab">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                        <h3 class="text-xl font-bold">Your Orders</h3>
                        <div class="relative w-full md:w-auto">
                            <input type="text" id="orderSearchInput" placeholder="Search orders..." class="py-2 pl-4 pr-10 rounded-md border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white text-base w-full">
                            <button onclick="searchOrders()" class="absolute right-0 top-0 h-full px-3 text-gray-500 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div id="ordersContainer">
                        <!-- Orders will be loaded here -->
                    </div>
                </div>
                
                <!-- Wishlist Tab -->
                <div id="wishlistTab" class="profile-tab">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                        <h3 class="text-xl font-bold">Your Wishlist</h3>
                        <div class="w-full md:w-auto">
                            <select id="wishlistSort" onchange="sortWishlist()" class="py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-base w-full">
                                <option value="date">Date Added</option>
                                <option value="price_low">Price: Low to High</option>
                                <option value="price_high">Price: High to Low</option>
                                <option value="name">Name</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="wishlistContainer" class="product-grid">
                        <!-- Wishlist items will be loaded here -->
                    </div>
                </div>
                
                <!-- Settings Tab -->
                <div id="settingsTab" class="profile-tab">
                    <div class="card p-6 mb-6">
                        <h3 class="text-xl font-bold mb-6">Account Settings</h3>
                        
                        <form id="accountSettingsForm" onsubmit="return updateAccountSettings(event)" class="space-y-5">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="form-group">
                                    <input type="text" id="settingsFirstName" class="form-input" placeholder=" ">
                                    <label for="settingsFirstName" class="form-label">First Name</label>
                                </div>
                                <div class="form-group">
                                    <input type="text" id="settingsLastName" class="form-input" placeholder=" ">
                                    <label for="settingsLastName" class="form-label">Last Name</label>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <input type="email" id="settingsEmail" class="form-input" placeholder=" ">
                                <label for="settingsEmail" class="form-label">Email Address</label>
                            </div>
                            
                            <div class="form-group">
                                <input type="tel" id="settingsPhone" class="form-input" placeholder=" ">
                                <label for="settingsPhone" class="form-label">Phone Number</label>
                            </div>
                            
                            <button type="submit" class="btn-primary py-2 px-6 rounded-md flex items-center">
                                <i class="fas fa-save mr-2"></i> Save Changes
                            </button>
                        </form>
                    </div>
                    
                    <div class="card p-6 mb-6">
                        <h3 class="text-xl font-bold mb-6">Change Password</h3>
                        
                        <form id="passwordChangeForm" onsubmit="return updatePassword(event)" class="space-y-5">
                            <div class="form-group">
                                <input type="password" id="currentPassword" class="form-input" placeholder=" " required>
                                <label for="currentPassword" class="form-label">Current Password</label>
                            </div>
                            
                            <div class="form-group">
                                <input type="password" id="newPassword" class="form-input" placeholder=" " required>
                                <label for="newPassword" class="form-label">New Password</label>
                            </div>
                            
                            <div class="form-group">
                                <input type="password" id="confirmNewPassword" class="form-input" placeholder=" " required>
                                <label for="confirmNewPassword" class="form-label">Confirm New Password</label>
                            </div>
                            
                            <button type="submit" class="btn-primary py-2 px-6 rounded-md flex items-center">
                                <i class="fas fa-key mr-2"></i> Update Password
                            </button>
                        </form>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold mb-6">Notification Preferences</h3>
                        
                        <div class="space-y-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-medium text-lg">Order Updates</h4>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Receive updates about your orders</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="orderNotifications" checked>
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-medium text-lg">Price Alerts</h4>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Get notified when products in your wishlist go on sale</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="priceAlerts" checked>
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-medium text-lg">Recommendations</h4>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Receive personalized product recommendations</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="recommendationAlerts" checked>
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-medium text-lg">Marketing Emails</h4>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Receive promotional offers and newsletters</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="marketingEmails">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            
                            <button onclick="saveNotificationPreferences()" class="btn-primary py-2 px-6 rounded-md flex items-center mt-4">
                                <i class="fas fa-bell mr-2"></i> Save Preferences
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="adminPage" class="page">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <!-- Sidebar -->
                <div class="md:col-span-1">
                    <div class="card p-6 sticky top-24">
                        <div class="flex items-center mb-6">
                            <div class="w-10 h-10 rounded-full bg-primary flex items-center justify-center mr-3">
                                <i class="fas fa-user-shield text-white"></i>
                            </div>
                            <div>
                                <h2 class="text-xl font-bold">Admin Panel</h2>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Manage your store</p>
                            </div>
                        </div>
                        
                        <div class="space-y-2">
                            <button onclick="showAdminTab('dashboard')" id="dashboardBtn" class="w-full text-left py-3 px-4 rounded-lg bg-primary text-white flex items-center transition-colors duration-200">
                                <i class="fas fa-tachometer-alt mr-3"></i> Dashboard
                            </button>
                            <button onclick="showAdminTab('products')" id="productsBtn" class="w-full text-left py-3 px-4 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 flex items-center transition-colors duration-200">
                                <i class="fas fa-box mr-3"></i> Products
                            </button>
                            <button onclick="showAdminTab('users')" id="usersBtn" class="w-full text-left py-3 px-4 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 flex items-center transition-colors duration-200">
                                <i class="fas fa-users mr-3"></i> Users
                            </button>
                            <button onclick="showAdminTab('analytics')" id="analyticsBtn" class="w-full text-left py-3 px-4 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 flex items-center transition-colors duration-200">
                                <i class="fas fa-chart-bar mr-3"></i> Analytics
                            </button>
                        </div>
                        
                        <div class="border-t border-gray-200 dark:border-gray-700 mt-6 pt-6">
                            <button onclick="logout()" class="w-full text-left py-3 px-4 rounded-lg text-red-500 hover:bg-red-100 dark:hover:bg-red-900/20 flex items-center transition-colors duration-200">
                                <i class="fas fa-sign-out-alt mr-3"></i> Logout
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Content Area -->
                <div class="md:col-span-3">
                    <!-- Dashboard Tab -->
                    <div id="dashboardTab" class="admin-tab">
                        <div class="mb-6">
                            <h2 class="text-2xl font-bold mb-2">Dashboard</h2>
                            <p class="text-gray-600 dark:text-gray-400">Welcome to your store admin dashboard</p>
                        </div>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <div class="card p-6">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">Total Sales</p>
                                        <h3 class="text-2xl font-bold">$12,345</h3>
                                        <p class="text-xs text-green-500 flex items-center"><i class="fas fa-arrow-up mr-1"></i> 12.5% from last month</p>
                                    </div>
                                    <div class="w-14 h-14 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center text-green-500">
                                        <i class="fas fa-dollar-sign text-2xl"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card p-6">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">Total Orders</p>
                                        <h3 class="text-2xl font-bold">283</h3>
                                        <p class="text-xs text-green-500 flex items-center"><i class="fas fa-arrow-up mr-1"></i> 8.2% from last month</p>
                                    </div>
                                    <div class="w-14 h-14 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-blue-500">
                                        <i class="fas fa-shopping-bag text-2xl"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card p-6">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">Active Users</p>
                                        <h3 class="text-2xl font-bold">1,254</h3>
                                        <p class="text-xs text-green-500 flex items-center"><i class="fas fa-arrow-up mr-1"></i> 18.3% from last month</p>
                                    </div>
                                    <div class="w-14 h-14 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center text-purple-500">
                                        <i class="fas fa-users text-2xl"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card p-6">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">Conversion Rate</p>
                                        <h3 class="text-2xl font-bold">4.2%</h3>
                                        <p class="text-xs text-red-500 flex items-center"><i class="fas fa-arrow-down mr-1"></i> 1.2% from last month</p>
                                    </div>
                                    <div class="w-14 h-14 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center text-orange-500">
                                        <i class="fas fa-chart-line text-2xl"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                            <div class="card p-6">
                                <h3 class="text-lg font-bold mb-4">Sales Overview</h3>
                                <div class="chart-container">
                                    <canvas id="salesChart"></canvas>
                                </div>
                            </div>
                            
                            <div class="card p-6">
                                <h3 class="text-lg font-bold mb-4">Recommendation Engine</h3>
                                <div class="chart-container">
                                    <canvas id="recommendationsChart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card p-6 mb-8">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-lg font-bold">Recent Orders</h3>
                                <a href="#" class="text-primary hover:text-primary-dark flex items-center text-sm">
                                    <span>View All</span>
                                    <i class="fas fa-arrow-right ml-2"></i>
                                </a>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="min-w-full">
                                    <thead>
                                        <tr>
                                            <th>Order ID</th>
                                            <th>Customer</th>
                                            <th>Products</th>
                                            <th>Total</th>
                                            <th>Status</th>
                                            <th>Date</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>ORD-10542</td>
                                            <td>John Smith</td>
                                            <td>3 items</td>
                                            <td>$249.97</td>
                                            <td><span class="px-2 py-1 rounded-full text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">Delivered</span></td>
                                            <td>May 12, 2023</td>
                                        </tr>
                                        <tr>
                                            <td>ORD-10541</td>
                                            <td>Sarah Johnson</td>
                                            <td>1 item</td>
                                            <td>$129.99</td>
                                            <td><span class="px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">Shipped</span></td>
                                            <td>May 12, 2023</td>
                                        </tr>
                                        <tr>
                                            <td>ORD-10540</td>
                                            <td>Michael Davis</td>
                                            <td>2 items</td>
                                            <td>$54.98</td>
                                            <td><span class="px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">Processing</span></td>
                                            <td>May 11, 2023</td>
                                        </tr>
                                        <tr>
                                            <td>ORD-10539</td>
                                            <td>Emma Wilson</td>
                                            <td>5 items</td>
                                            <td>$312.45</td>
                                            <td><span class="px-2 py-1 rounded-full text-xs bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200">Pending</span></td>
                                            <td>May 11, 2023</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="card p-6">
                            <h3 class="text-lg font-bold mb-4">Latest Activities</h3>
                            <div class="space-y-4">
                                <div class="flex items-start">
                                    <div class="min-w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-blue-500 mr-4">
                                        <i class="fas fa-shopping-bag"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium">New Order <span class="text-primary">#10543</span></p>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">James Wilson placed a new order for $128.45</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-500 mt-1">10 minutes ago</p>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <div class="min-w-10 h-10 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center text-green-500 mr-4">
                                        <i class="fas fa-user-plus"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium">New User Registration</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Emily Johnson created a new account</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-500 mt-1">1 hour ago</p>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <div class="min-w-10 h-10 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center text-yellow-500 mr-4">
                                        <i class="fas fa-star"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium">New Product Review</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Michael Brown left a 5-star review on "Wireless Headphones"</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-500 mt-1">3 hours ago</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Products Tab -->
                    <div id="productsTab" class="admin-tab hidden">
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                            <div>
                                <h2 class="text-2xl font-bold mb-1">Products Management</h2>
                                <p class="text-gray-600 dark:text-gray-400">Manage your store's product inventory</p>
                            </div>
                            <button onclick="openAddProductModal()" class="btn-primary py-2 px-4 rounded-md flex items-center whitespace-nowrap">
                                <i class="fas fa-plus mr-2"></i> Add Product
                            </button>
                        </div>
                        
                        <div class="card p-6 mb-8">
                            <div class="flex flex-col md:flex-row gap-4 mb-6">
                                <div class="relative flex-grow">
                                    <input type="text" id="productSearchAdmin" placeholder="Search products..." class="w-full py-2 pl-4 pr-10 rounded-md border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white text-base">
                                    <button onclick="searchAdminProducts()" class="absolute right-0 top-0 h-full px-3 text-gray-500 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                                
                                <select id="categoryFilterAdmin" onchange="filterAdminProducts()" class="py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-base">
                                    <option value="">All Categories</option>
                                    <option value="electronics">Electronics</option>
                                    <option value="clothing">Clothing</option>
                                    <option value="home">Home & Kitchen</option>
                                    <option value="books">Books</option>
                                    <option value="beauty">Beauty</option>
                                </select>
                            </div>
                            
                            <div class="overflow-x-auto">
                                <table class="min-w-full">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Image</th>
                                            <th>Name</th>
                                            <th>Category</th>
                                            <th>Price</th>
                                            <th>Stock</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="productsTableAdmin">
                                        <!-- Products will be loaded here -->
                                    </tbody>
                                </table>
                            </div>

                            <div class="mt-6 flex items-center justify-between">
                                <p class="text-sm text-gray-600 dark:text-gray-400">Showing <span id="productsShowing">0</span> of <span id="productsTotal">0</span> products</p>
                                <div class="flex space-x-2">
                                    <button class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                                        <i class="fas fa-chevron-left"></i>
                                    </button>
                                    <button class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                                        <i class="fas fa-chevron-right"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="card p-6">
                            <h3 class="text-lg font-bold mb-4">Inventory Overview</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="bg-red-50 dark:bg-red-900/20 p-4 rounded-lg">
                                    <div class="flex items-center">
                                        <div class="w-12 h-12 rounded-full bg-red-100 dark:bg-red-800 flex items-center justify-center text-red-500 mr-4">
                                            <i class="fas fa-exclamation-triangle"></i>
                                        </div>
                                        <div>
                                            <h4 class="font-bold">Low Stock</h4>
                                            <p class="text-2xl font-bold text-red-500">3 products</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg">
                                    <div class="flex items-center">
                                        <div class="w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-800 flex items-center justify-center text-yellow-500 mr-4">
                                            <i class="fas fa-box-open"></i>
                                        </div>
                                        <div>
                                            <h4 class="font-bold">Need Restock</h4>
                                            <p class="text-2xl font-bold text-yellow-500">7 products</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg">
                                    <div class="flex items-center">
                                        <div class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-800 flex items-center justify-center text-green-500 mr-4">
                                            <i class="fas fa-check-circle"></i>
                                        </div>
                                        <div>
                                            <h4 class="font-bold">Well Stocked</h4>
                                            <p class="text-2xl font-bold text-green-500">42 products</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Users Tab -->
                    <div id="usersTab" class="admin-tab hidden">
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                            <div>
                                <h2 class="text-2xl font-bold mb-1">Users Management</h2>
                                <p class="text-gray-600 dark:text-gray-400">Manage your customer accounts</p>
                            </div>
                            <button onclick="openAddUserModal()" class="btn-primary py-2 px-4 rounded-md flex items-center">
                                <i class="fas fa-user-plus mr-2"></i> Add User
                            </button>
                        </div>
                        
                        <div class="card p-6 mb-8">
                            <div class="flex flex-col md:flex-row gap-4 mb-6">
                                <div class="relative flex-grow">
                                    <input type="text" id="userSearchAdmin" placeholder="Search users..." class="w-full py-2 pl-4 pr-10 rounded-md border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white text-base">
                                    <button onclick="searchAdminUsers()" class="absolute right-0 top-0 h-full px-3 text-gray-500 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                                
                                <select id="roleFilterAdmin" onchange="filterAdminUsers()" class="py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-base">
                                    <option value="">All Roles</option>
                                    <option value="admin">Admin</option>
                                    <option value="customer">Customer</option>
                                </select>
                            </div>
                            
                            <div class="overflow-x-auto">
                                <table class="min-w-full">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Name</th>
                                            <th>Email</th>
                                            <th>Role</th>
                                            <th>Last Active</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="usersTableAdmin">
                                        <!-- Users will be loaded here -->
                                    </tbody>
                                </table>
                            </div>

                            <div class="mt-6 flex items-center justify-between">
                                <p class="text-sm text-gray-600 dark:text-gray-400">Showing <span id="usersShowing">0</span> of <span id="usersTotal">0</span> users</p>
                                <div class="flex space-x-2">
                                    <button class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                                        <i class="fas fa-chevron-left"></i>
                                    </button>
                                    <button class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                                        <i class="fas fa-chevron-right"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="card p-6">
                            <h3 class="text-lg font-bold mb-4">User Activity</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-semibold mb-4">New Users This Month</h4>
                                    <div class="chart-container">
                                        <canvas id="newUsersChart"></canvas>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-4">User Engagement</h4>
                                    <div class="space-y-4">
                                        <div>
                                            <div class="flex justify-between mb-2">
                                                <span class="text-gray-600 dark:text-gray-400">Daily Active Users</span>
                                                <span class="text-gray-600 dark:text-gray-400">624</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden">
                                                <div class="bg-primary h-2.5 rounded-full" style="width: 62%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between mb-2">
                                                <span class="text-gray-600 dark:text-gray-400">Weekly Active Users</span>
                                                <span class="text-gray-600 dark:text-gray-400">1,892</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden">
                                                <div class="bg-primary h-2.5 rounded-full" style="width: 78%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between mb-2">
                                                <span class="text-gray-600 dark:text-gray-400">Monthly Active Users</span>
                                                <span class="text-gray-600 dark:text-gray-400">3,245</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden">
                                                <div class="bg-primary h-2.5 rounded-full" style="width: 85%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Analytics Tab -->
                    <div id="analyticsTab" class="admin-tab hidden">
                        <div class="mb-6">
                            <h2 class="text-2xl font-bold mb-1">Analytics</h2>
                            <p class="text-gray-600 dark:text-gray-400">Monitor your store's performance and recommendation system</p>
                        </div>
                        
                        <div class="card p-6 mb-8">
                            <h3 class="text-lg font-bold mb-6">Recommendation System Performance</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                <div class="bg-gray-100 dark:bg-gray-700 p-6 rounded-lg">
                                    <p class="text-gray-600 dark:text-gray-400 text-sm mb-1">Click-Through Rate</p>
                                    <h4 class="text-2xl font-bold mb-1">24.8%</h4>
                                    <p class="text-xs text-green-500 flex items-center"><i class="fas fa-arrow-up mr-1"></i> 3.2% from last month</p>
                                </div>
                                <div class="bg-gray-100 dark:bg-gray-700 p-6 rounded-lg">
                                    <p class="text-gray-600 dark:text-gray-400 text-sm mb-1">Conversion Rate</p>
                                    <h4 class="text-2xl font-bold mb-1">7.3%</h4>
                                    <p class="text-xs text-green-500 flex items-center"><i class="fas fa-arrow-up mr-1"></i> 1.5% from last month</p>
                                </div>
                                <div class="bg-gray-100 dark:bg-gray-700 p-6 rounded-lg">
                                    <p class="text-gray-600 dark:text-gray-400 text-sm mb-1">Engagement Time</p>
                                    <h4 class="text-2xl font-bold mb-1">5.2 mins</h4>
                                    <p class="text-xs text-green-500 flex items-center"><i class="fas fa-arrow-up mr-1"></i> 0.8 mins from last month</p>
                                </div>
                            </div>
                            
                            <h4 class="font-bold mb-4">Algorithm Performance</h4>
                            <div class="overflow-x-auto">
                                <table class="min-w-full">
                                    <thead>
                                        <tr>
                                            <th>Algorithm</th>
                                            <th>Precision</th>
                                            <th>Recall</th>
                                            <th>F1 Score</th>
                                            <th>Response Time</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Collaborative Filtering</td>
                                            <td>0.82</td>
                                            <td>0.79</td>
                                            <td>0.80</td>
                                            <td>245ms</td>
                                        </tr>
                                        <tr>
                                            <td>Content-Based Filtering</td>
                                            <td>0.75</td>
                                            <td>0.83</td>
                                            <td>0.79</td>
                                            <td>180ms</td>
                                        </tr>
                                        <tr>
                                            <td>Hybrid Approach</td>
                                            <td>0.88</td>
                                            <td>0.85</td>
                                            <td>0.86</td>
                                            <td>310ms</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div class="card p-6 mb-8">
                            <h3 class="text-lg font-bold mb-6">User Segments</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <div class="chart-container">
                                    <canvas id="userSegmentsChart"></canvas>
                                </div>
                                
                                <div>
                                    <h4 class="font-bold mb-4">Top User Interests</h4>
                                    <div class="space-y-4">
                                        <div>
                                            <div class="flex justify-between mb-2">
                                                <span class="text-gray-600 dark:text-gray-400">Electronics</span>
                                                <span class="text-gray-600 dark:text-gray-400">42%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden">
                                                <div class="bg-primary h-2.5 rounded-full" style="width: 42%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between mb-2">
                                                <span class="text-gray-600 dark:text-gray-400">Clothing</span>
                                                <span class="text-gray-600 dark:text-gray-400">28%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden">
                                                <div class="bg-primary h-2.5 rounded-full" style="width: 28%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between mb-2">
                                                <span class="text-gray-600 dark:text-gray-400">Home & Kitchen</span>
                                                <span class="text-gray-600 dark:text-gray-400">18%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden">
                                                <div class="bg-primary h-2.5 rounded-full" style="width: 18%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between mb-2">
                                                <span class="text-gray-600 dark:text-gray-400">Books</span>
                                                <span class="text-gray-600 dark:text-gray-400">12%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden">
                                                <div class="bg-primary h-2.5 rounded-full" style="width: 12%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card p-6">
                            <h3 class="text-lg font-bold mb-4">Recommendation Effectiveness</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-semibold mb-4">Recommendation to Purchase Conversion</h4>
                                    <div class="chart-container">
                                        <canvas id="conversionChart"></canvas>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-4">Most Successful Recommendations</h4>
                                    <div class="space-y-4">
                                        <div class="flex items-center p-3 bg-gray-100 dark:bg-gray-700 rounded-lg">
                                            <div class="w-12 h-12 rounded-md overflow-hidden mr-4">
                                                <img src="static/images/electronics/headphones1.jpg" alt="Wireless Headphones" class="w-full h-full object-cover">
                                            </div>
                                            <div class="flex-grow">
                                                <h5 class="font-medium">Wireless Headphones</h5>
                                                <div class="flex items-center text-yellow-400 text-xs">
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star-half-alt"></i>
                                                </div>
                                            </div>
                                            <div class="text-right">
                                                <span class="block font-bold">78%</span>
                                                <span class="text-xs text-gray-600 dark:text-gray-400">conversion</span>
                                            </div>
                                        </div>
                                        <div class="flex items-center p-3 bg-gray-100 dark:bg-gray-700 rounded-lg">
                                            <div class="w-12 h-12 rounded-md overflow-hidden mr-4">
                                                <img src="static/images/electronics/watch1.jpg" alt="Smart Watch" class="w-full h-full object-cover">
                                            </div>
                                            <div class="flex-grow">
                                                <h5 class="font-medium">Smart Watch</h5>
                                                <div class="flex items-center text-yellow-400 text-xs">
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="far fa-star"></i>
                                                </div>
                                            </div>
                                            <div class="text-right">
                                                <span class="block font-bold">72%</span>
                                                <span class="text-xs text-gray-600 dark:text-gray-400">conversion</span>
                                            </div>
                                        </div>
                                        <div class="flex items-center p-3 bg-gray-100 dark:bg-gray-700 rounded-lg">
                                            <div class="w-12 h-12 rounded-md overflow-hidden mr-4">
                                                <img src="static/images/beauty/serum1.jpg" alt="Face Serum" class="w-full h-full object-cover">
                                            </div>
                                            <div class="flex-grow">
                                                <h5 class="font-medium">Premium Face Serum</h5>
                                                <div class="flex items-center text-yellow-400 text-xs">
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                </div>
                                            </div>
                                            <div class="text-right">
                                                <span class="block font-bold">65%</span>
                                                <span class="text-xs text-gray-600 dark:text-gray-400">conversion</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add Product Modal -->
    <div id="addProductModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeAddProductModal()">&times;</span>
            <h2 class="text-xl font-bold mb-6">Add New Product</h2>
            
            <form id="addProductForm" onsubmit="return handleAddProduct(event)" class="space-y-5">
                <div class="form-group">
                    <input type="text" id="productName" class="form-input" placeholder=" " required>
                    <label for="productName" class="form-label">Product Name</label>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                    <div class="form-group">
                        <input type="text" id="productBrand" class="form-input" placeholder=" " required>
                        <label for="productBrand" class="form-label">Brand</label>
                    </div>
                    
                    <div class="form-group">
                        <select id="productCategory" class="form-input" required>
                            <option value="" selected disabled hidden></option>
                            <option value="electronics">Electronics</option>
                            <option value="clothing">Clothing</option>
                            <option value="home">Home & Kitchen</option>
                            <option value="books">Books</option>
                            <option value="beauty">Beauty</option>
                            <option value="sports">Sports & Outdoors</option>
                        </select>
                        <label for="productCategory" class="form-label">Category</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <textarea id="productDescription" rows="3" class="form-input" placeholder=" " required></textarea>
                    <label for="productDescription" class="form-label">Description</label>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                    <div class="form-group">
                        <input type="number" id="productPrice" step="0.01" min="0" class="form-input" placeholder=" " required>
                        <label for="productPrice" class="form-label">Price ($)</label>
                    </div>
                    
                    <div class="form-group">
                        <input type="number" id="productStock" min="0" class="form-input" placeholder=" " required>
                        <label for="productStock" class="form-label">Stock Quantity</label>
                    </div>
                </div>
                
                <input type="hidden" id="productId">
                <div class="flex space-x-3 pt-2">
                    <button type="button" onclick="closeAddProductModal()" class="flex-1 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        Cancel
                    </button>
                    <button type="submit" class="flex-1 btn-primary py-2 px-4 rounded-md">Save Product</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add User Modal -->
    <div id="addUserModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeAddUserModal()">&times;</span>
            <h2 class="text-xl font-bold mb-6">Add New User</h2>
            
            <form id="addUserForm" onsubmit="return handleAddUser(event)" class="space-y-5">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                    <div class="form-group">
                        <input type="text" id="userFirstName" class="form-input" placeholder=" " required>
                        <label for="userFirstName" class="form-label">First Name</label>
                    </div>
                    
                    <div class="form-group">
                        <input type="text" id="userLastName" class="form-input" placeholder=" " required>
                        <label for="userLastName" class="form-label">Last Name</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <input type="email" id="userEmail" class="form-input" placeholder=" " required>
                    <label for="userEmail" class="form-label">Email Address</label>
                </div>
                
                <div class="form-group">
                    <input type="password" id="userPassword" class="form-input" placeholder=" ">
                    <label for="userPassword" class="form-label">Password</label>
                    <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Leave blank to keep current password when editing</p>
                </div>
                
                <div class="form-group">
                    <select id="userRole" class="form-input" required>
                        <option value="" selected disabled hidden></option>
                        <option value="customer">Customer</option>
                        <option value="admin">Admin</option>
                    </select>
                    <label for="userRole" class="form-label">Role</label>
                </div>
                
                <input type="hidden" id="userId">
                <div class="flex space-x-3 pt-2">
                    <button type="button" onclick="closeAddUserModal()" class="flex-1 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        Cancel
                    </button>
                    <button type="submit" class="flex-1 btn-primary py-2 px-4 rounded-md">Save User</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Product Details Modal -->
    <div id="productDetailsModal" class="modal">
        <div class="modal-content max-w-4xl">
            <span class="close-modal" onclick="closeProductDetailsModal()">&times;</span>
            <div id="productDetailsContent">
                <!-- Product details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Shopping Assistant Modal -->
    <div id="shoppingAssistantModal" class="modal">
        <div class="modal-content max-w-2xl">
            <span class="close-modal" onclick="closeShoppingAssistantModal()">&times;</span>
            <h2 class="text-xl font-bold mb-6">Shopping Assistant</h2>
            <div class="mb-4">
                <p class="text-gray-600 dark:text-gray-400 mb-4">Tell me what you're looking for and I'll help you find the perfect products.</p>
                <div id="assistantMessages" class="bg-gray-100 dark:bg-gray-800 rounded-lg p-4 h-64 overflow-y-auto mb-4">
                    <div class="flex items-start mb-4">
                        <div class="min-w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center mr-2">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg py-2 px-4 shadow-sm max-w-xs">
                            <p>Hi! I'm your shopping assistant. How can I help you today?</p>
                        </div>
                    </div>
                </div>
                <div class="flex">
                    <input type="text" id="assistantInput" placeholder="e.g. I need a gift for my mom who loves cooking" class="flex-grow form-input">
                    <button id="sendToAssistant" class="btn-primary ml-2 px-4 rounded-md flex items-center justify-center">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Checkout Modal -->
    <div id="checkoutModal" class="modal">
        <div class="modal-content max-w-2xl">
            <span class="close-modal" onclick="closeCheckoutModal()">&times;</span>
            <h2 class="text-xl font-bold mb-6">Complete Your Order</h2>
            <div id="checkoutContent">
                <div id="checkoutItems" class="mb-6">
                    <!-- Checkout items will be loaded here -->
                </div>
                
                <div class="border-t border-gray-200 dark:border-gray-700 pt-4 mb-6">
                    <div class="flex justify-between mb-2">
                        <span class="text-gray-600 dark:text-gray-400">Subtotal:</span>
                        <span id="checkoutSubtotal" class="font-semibold">$0.00</span>
                    </div>
                    <div class="flex justify-between mb-2">
                        <span class="text-gray-600 dark:text-gray-400">Shipping:</span>
                        <span id="checkoutShipping" class="font-semibold">$0.00</span>
                    </div>
                    <div class="flex justify-between mb-2">
                        <span class="text-gray-600 dark:text-gray-400">Tax:</span>
                        <span id="checkoutTax" class="font-semibold">$0.00</span>
                    </div>
                    <div class="flex justify-between text-lg font-bold mt-4">
                        <span>Total:</span>
                        <span id="checkoutTotal">$0.00</span>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h3 class="font-semibold mb-3">Shipping Address</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="form-group">
                            <input type="text" id="shippingName" class="form-input" placeholder=" " required>
                            <label for="shippingName" class="form-label">Full Name</label>
                        </div>
                        <div class="form-group">
                            <input type="text" id="shippingPhone" class="form-input" placeholder=" " required>
                            <label for="shippingPhone" class="form-label">Phone Number</label>
                        </div>
                        <div class="form-group md:col-span-2">
                            <input type="text" id="shippingAddress" class="form-input" placeholder=" " required>
                            <label for="shippingAddress" class="form-label">Address</label>
                        </div>
                        <div class="form-group">
                            <input type="text" id="shippingCity" class="form-input" placeholder=" " required>
                            <label for="shippingCity" class="form-label">City</label>
                        </div>
                        <div class="form-group">
                            <input type="text" id="shippingZip" class="form-input" placeholder=" " required>
                            <label for="shippingZip" class="form-label">Zip Code</label>
                        </div>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h3 class="font-semibold mb-3">Payment Method</h3>
                    <div class="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg">
                        <p>For demo purposes, no actual payment will be processed.</p>
                    </div>
                </div>
                
                <div class="flex justify-end">
                    <button onclick="closeCheckoutModal()" class="py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200 mr-4">
                        Cancel
                    </button>
                    <button onclick="completeOrder()" class="btn-primary py-2 px-6 rounded-md">
                        Place Order
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast flex items-center shadow-lg">
        <i class="fas fa-info-circle mr-3 text-lg"></i>
        <span id="toastMessage"></span>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-100 dark:bg-gray-800 py-10">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between">
                <div class="mb-8 md:mb-0 md:w-1/3">
                    <div class="flex items-center space-x-2 mb-6">
                        <i class="fas fa-shopping-cart text-2xl text-primary"></i>
                        <span class="text-xl font-bold text-gray-800 dark:text-white">ShopSmart</span>
                    </div>
                    <p class="text-gray-600 dark:text-gray-400 mb-6 max-w-md">Personalized shopping experiences powered by advanced recommendation technology. Find products you'll love with our AI-driven platform.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-600 dark:text-gray-400 hover:bg-primary hover:text-white transition-colors duration-200">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-600 dark:text-gray-400 hover:bg-primary hover:text-white transition-colors duration-200">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-600 dark:text-gray-400 hover:bg-primary hover:text-white transition-colors duration-200">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-600 dark:text-gray-400 hover:bg-primary hover:text-white transition-colors duration-200">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-3 gap-8 md:w-2/3">
                    <div>
                        <h3 class="text-lg font-semibold mb-6 text-gray-800 dark:text-white">Shop</h3>
                        <ul class="space-y-4">
                            <li><a href="#" onclick="navigateTo('categories')" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">Categories</a></li>
                            <li><a href="#" onclick="navigateTo('recommendations')" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">Recommendations</a></li>
                            <li><a href="#" onclick="navigateTo('home')" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">Popular Products</a></li>
                            <li><a href="#" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">New Arrivals</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-semibold mb-6 text-gray-800 dark:text-white">Account</h3>
                        <ul class="space-y-4">
                            <li><a href="#" onclick="navigateTo('login')" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">Login</a></li>
                            <li><a href="#" onclick="navigateTo('register')" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">Register</a></li>
                            <li><a href="#" onclick="navigateTo('profile')" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">My Account</a></li>
                            <li><a href="#" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">Order History</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-semibold mb-6 text-gray-800 dark:text-white">About</h3>
                        <ul class="space-y-4">
                            <li><a href="#" onclick="navigateTo('about')" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">Our Technology</a></li>
                            <li><a href="#" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">Privacy Policy</a></li>
                            <li><a href="#" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">Terms of Service</a></li>
                            <li><a href="#" class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">Contact Us</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-gray-200 dark:border-gray-700 mt-10 pt-8 flex flex-col md:flex-row justify-between items-center">
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-4 md:mb-0">© 2024 ShopSmart. Kiplagat Cosmas . All rights reserved.</p>
                <div class="flex space-x-6">
                    <a href="#" class="text-sm text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">Privacy Policy</a>
                    <a href="#" class="text-sm text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">Terms of Service</a>
                    <a href="#" class="text-sm text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors duration-200">Cookie Policy</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Global state
        let currentUser = null;
        let currentPage = 1;
        let itemsPerPage = 8;
        let currentCategory = 'all';
        let currentSortOption = 'popularity';
        let minPriceFilter = null;
        let maxPriceFilter = null;
        let searchQuery = '';
        let viewMode = 'grid';
        let recentlyViewedProducts = [];
        let cartItems = []; // Track items in cart

        // Mock data for users
        const mockUsers = [
            {
                id: 1,
                first_name: "Admin",
                last_name: "User",
                email: "admin@example.com",
                password: "admin123",
                role: "admin",
                last_active: new Date().toISOString(),
                created_at: "2022-01-15T00:00:00Z",
                phone: "+1234567890"
            },
            {
                id: 2,
                first_name: "John",
                last_name: "Smith",
                email: "john@example.com",
                password: "password123",
                role: "customer",
                last_active: new Date().toISOString(),
                created_at: "2022-03-10T00:00:00Z",
                phone: "+9876543210"
            },
            {
                id: 3,
                first_name: "Sarah",
                last_name: "Johnson",
                email: "sarah@example.com",
                password: "password123",
                role: "customer",
                last_active: new Date().toISOString(),
                created_at: "2022-05-20T00:00:00Z",
                phone: "+1122334455"
            },
            {
                id: 4,
                first_name: "Michael",
                last_name: "Davis",
                email: "michael@example.com",
                password: "password123",
                role: "customer",
                last_active: new Date().toISOString(),
                created_at: "2022-07-12T00:00:00Z",
                phone: "+5544332211"
            }
        ];

        // Mock data for orders
        const mockOrders = [
            {
                id: 10542,
                user_id: 2,
                items: [
                    { product_id: 1, quantity: 1, price: 499.99 },
                    { product_id: 5, quantity: 1, price: 79.99 },
                    { product_id: 8, quantity: 1, price: 29.99 }
                ],
                total: 609.97,
                status: "delivered",
                date: "2023-05-12T14:23:45Z"
            },
            {
                id: 10541,
                user_id: 3,
                items: [
                    { product_id: 2, quantity: 1, price: 199.99 }
                ],
                total: 199.99,
                status: "shipped",
                date: "2023-05-12T10:15:30Z"
            },
            {
                id: 10540,
                user_id: 4,
                items: [
                    { product_id: 6, quantity: 1, price: 24.99 },
                    { product_id: 7, quantity: 2, price: 29.98 }
                ],
                total: 54.97,
                status: "processing",
                date: "2023-05-11T16:48:22Z"
            },
            {
                id: 10539,
                user_id: 2,
                items: [
                    { product_id: 3, quantity: 1, price: 89.99 },
                    { product_id: 4, quantity: 1, price: 59.99 },
                    { product_id: 5, quantity: 1, price: 79.99 },
                    { product_id: 6, quantity: 2, price: 49.98 },
                    { product_id: 8, quantity: 1, price: 29.99 }
                ],
                total: 309.94,
                status: "pending",
                date: "2023-05-11T09:30:15Z"
            },
            {
                id: 10538,
                user_id: 2,
                items: [
                    { product_id: 1, quantity: 1, price: 499.99 }
                ],
                total: 499.99,
                status: "delivered",
                date: "2023-04-28T13:20:10Z"
            },
            {
                id: 10537,
                user_id: 2,
                items: [
                    { product_id: 7, quantity: 1, price: 14.99 },
                    { product_id: 8, quantity: 1, price: 29.99 }
                ],
                total: 44.98,
                status: "delivered",
                date: "2023-04-15T11:45:32Z"
            }
        ];

        // Mock data for wishlist
        const mockWishlist = [
            {
                user_id: 2,
                products: [2, 4, 6, 8, 10, 12, 14, 16]
            }
        ];

        // Mock data for products
        const mockProducts = [
            {
                id: 1,
                name: "Smart 4K TV",
                brand: "TechPro",
                category: "electronics",
                price: 499.99,
                rating: 4.7,
                reviews_count: 245,
                stock: 12,
                image: "static/images/electronics/tv.webp",
                description: "Ultra HD Smart TV with built-in streaming services and voice control."
            },
            {
                id: 2,
                name: "Wireless Noise-Canceling Headphones",
                brand: "AudioMax",
                category: "electronics",
                price: 199.99,
                rating: 4.8,
                reviews_count: 187,
                stock: 25,
                image: "static/images/electronics/bluetooth.webp",
                description: "Premium wireless headphones with active noise cancellation and 30-hour battery life."
            },
            {
                id: 3,
                name: "Professional Chef Knife",
                brand: "CulinaryPro",
                category: "home",
                price: 89.99,
                rating: 4.9,
                reviews_count: 120,
                stock: 18,
                image: "static/images/home/knife.webp",
                description: "High-carbon stainless steel chef knife, perfect for professional and home cooks."
            },
            {
                id: 4,
                name: "Leather Crossbody Bag",
                brand: "Urban Style",
                category: "clothing",
                price: 59.99,
                rating: 4.5,
                reviews_count: 98,
                stock: 30,
                image: "static/images/sports/bag.webp",
                description: "Genuine leather crossbody bag with adjustable strap and multiple compartments."
            },
            {
                id: 5,
                name: "Fitness Tracker Watch",
                brand: "FitTech",
                category: "electronics",
                price: 79.99,
                rating: 4.6,
                reviews_count: 156,
                stock: 22,
                image: "static/images/electronics/watch2.webp",
                description: "Water-resistant fitness tracker with heart rate monitor and sleep tracking."
            },
            {
                id: 6,
                name: "Organic Cotton T-Shirt",
                brand: "EcoWear",
                category: "clothing",
                price: 24.99,
                rating: 4.4,
                reviews_count: 75,
                stock: 50,
                image: "static/images/sports/shirt.webp",
                description: "Soft, breathable organic cotton t-shirt. Sustainably made and ethically sourced."
            },
            {
                id: 7,
                name: "Mystery Thriller Novel",
                brand: "PageTurner",
                category: "books",
                price: 14.99,
                rating: 4.3,
                reviews_count: 62,
                stock: 40,
                image: "static/images/books/novel1.webp",
                description: "Best-selling mystery thriller novel that will keep you on the edge of your seat."
            },
            {
                id: 8,
                name: "Premium Face Serum",
                brand: "GlowUp",
                category: "beauty",
                price: 29.99,
                rating: 4.7,
                reviews_count: 110,
                stock: 15,
                image: "static/images/beauty/serum.webp",
                description: "Hydrating face serum with vitamin C and hyaluronic acid for radiant skin."
            },
            {
                id: 9,
                name: "Wireless Noise-Canceling Headphones",
                brand: "SoundPro",
                category: "electronics",
                price: 199.99,
                rating: 4.8,
                reviews_count: 230,
                stock: 50,
                image: "static/images/electronics/bluetooth1.webp",
                description: "Premium noise-canceling headphones with 40-hour battery life."
            },
            {
                id: 10,
                name: "Smartphone 5G",
                brand: "TechNova",
                category: "electronics",
                price: 899.99,
                rating: 4.6,
                reviews_count: 540,
                stock: 25,
                image: "static/images/electronics/phone.webp",
                description: "Latest 5G smartphone with ultra-fast processing and advanced camera features."
            },
            {
                id: 11,
                name: "Men's Slim Fit Jeans",
                brand: "DenimMax",
                category: "clothing",
                price: 49.99,
                rating: 4.4,
                reviews_count: 185,
                stock: 70,
                image: "static/images/sports/jeans.webp",
                description: "Stylish and comfortable slim-fit jeans for men."
            },
            {
                id: 12,
                name: "Women's Floral Maxi Dress",
                brand: "FashionTrend",
                category: "clothing",
                price: 69.99,
                rating: 4.5,
                reviews_count: 250,
                stock: 40,
                image: "static/images/sports/dress.webp",
                description: "Elegant floral maxi dress, perfect for summer outings."
            },
            {
                id: 13,
                name: "Smart LED TV 55-inch",
                brand: "VisionTech",
                category: "electronics",
                price: 649.99,
                rating: 4.7,
                reviews_count: 390,
                stock: 30,
                image: "static/images/electronics/tv1.webp",
                description: "Ultra HD Smart LED TV with stunning picture quality and streaming capabilities."
            },
            {
                id: 14,
                name: "Electric Coffee Maker",
                brand: "BrewMaster",
                category: "home",
                price: 89.99,
                rating: 4.5,
                reviews_count: 120,
                stock: 50,
                image: "static/images/home/coffee.webp",
                description: "Automatic coffee maker with programmable brewing options."
            },
            {
                id: 15,
                name: "Sci-Fi Adventure Book",
                brand: "Galactic Reads",
                category: "books",
                price: 19.99,
                rating: 4.8,
                reviews_count: 95,
                stock: 60,
                image: "static/images/books/scifi.webp",
                description: "Exciting sci-fi adventure book set in a futuristic world."
            },
            {
                id: 16,
                name: "Hydrating Body Lotion",
                brand: "SkinCarePlus",
                category: "beauty",
                price: 24.99,
                rating: 4.6,
                reviews_count: 140,
                stock: 80,
                image: "static/images/beauty/lotion.webp",
                description: "Moisturizing body lotion with aloe vera and shea butter."
            },
            {
                id: 17,
                name: "Men's Sports Watch",
                brand: "TimeTrack",
                category: "electronics",
                price: 129.99,
                rating: 4.5,
                reviews_count: 210,
                stock: 35,
                image: "static/images/electronics/sp.webp",
                description: "Durable and stylish sports watch with water resistance."
            },
            {
                id: 18,
                name: "Portable Bluetooth Speaker",
                brand: "SoundBlast",
                category: "electronics",
                price: 49.99,
                rating: 4.7,
                reviews_count: 360,
                stock: 100,
                image: "static/images/electronics/speaker.webp",
                description: "Wireless Bluetooth speaker with deep bass and 12-hour playtime."
            },
            {
                id: 19,
                name: "Women's Running Shoes",
                brand: "SportFit",
                category: "clothing",
                price: 79.99,
                rating: 4.6,
                reviews_count: 275,
                stock: 45,
                image: "static/images/sports/shoes.webp",
                description: "Lightweight and comfortable running shoes with breathable material."
            },
            {
                id: 20,
                name: "Home Air Purifier",
                brand: "PureAir",
                category: "home",
                price: 199.99,
                rating: 4.8,
                reviews_count: 180,
                stock: 20,
                image: "static/images/home/purifier.webp",
                description: "Advanced air purifier with HEPA filter for clean indoor air."
            },
            {
                id: 21,
                name: "Classic Literature Novel",
                brand: "Timeless Reads",
                category: "books",
                price: 12.99,
                rating: 4.9,
                reviews_count: 320,
                stock: 70,
                image: "static/images/books/novel.webp",
                description: "A timeless classic novel with deep storytelling."
            },
            {
                id: 22,
                name: "Vitamin C Face Cream",
                brand: "GlowEssence",
                category: "beauty",
                price: 34.99,
                rating: 4.7,
                reviews_count: 95,
                stock: 60,
                image: "static/images/beauty/serum1.webp",
                description: "Brightening face cream with vitamin C and SPF protection."
            }
        ];

        // Utility Functions
        function showToast(message, duration = 3000) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toastMessage.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        // Dark Mode Functions
        document.getElementById('darkModeToggle').addEventListener('click', toggleDarkMode);

        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
        }

        // Check for user's preference
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }

        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Mobile Menu Toggle
        document.getElementById('mobileMenuBtn').addEventListener('click', toggleMobileMenu);

        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('show');
            
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            if (mobileMenu.classList.contains('show')) {
                mobileMenuBtn.innerHTML = '<i class="fas fa-times text-xl"></i>';
            } else {
                mobileMenuBtn.innerHTML = '<i class="fas fa-bars text-xl"></i>';
            }
        }

        // Navigation Functions
        function navigateTo(page) {
            const pages = document.querySelectorAll('.page');
            pages.forEach(p => p.classList.remove('active-page'));
            document.getElementById(`${page}Page`).classList.add('active-page');
            
            // Update active navigation link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                link.classList.remove('text-primary');
                if (link.textContent.toLowerCase().includes(page.toLowerCase())) {
                    link.classList.add('active');
                    link.classList.add('text-primary');
                }
            });
            
            // Specific page initializations
            if (page === 'recommendations') {
                loadRecommendations();
            } else if (page === 'admin' && (!currentUser || currentUser.role !== 'admin')) {
                navigateTo('login');
                showToast('You need to login as admin to access this page');
            } else if (page === 'admin') {
                initAdminDashboard();
            } else if (page === 'profile') {
                if (!currentUser) {
                    navigateTo('login');
                    showToast('Please log in to view your profile');
                    return;
                }
                initUserProfile();
            }
            
            // Close mobile menu if open
            const mobileMenu = document.getElementById('mobileMenu');
            if (mobileMenu.classList.contains('show')) {
                toggleMobileMenu();
            }
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Check if already logged in on page load
        function checkAuthStatus() {
            const storedUser = localStorage.getItem('currentUser');
            if (storedUser) {
                try {
                    currentUser = JSON.parse(storedUser);
                    updateUserUI();
                    updateRecentlyViewed();
                } catch (error) {
                    console.error('Error parsing stored user:', error);
                    localStorage.removeItem('currentUser');
                }
            }
        }

        // Authentication Functions
        async function handleLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Find user in mock data
            const user = mockUsers.find(u => u.email === email && u.password === password);
            
            if (user) {
                // Store user information (exclude password)
                const { password: _, ...userInfo } = user;
                currentUser = userInfo;
                
                // Store in localStorage for persistence
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // Update UI
                updateUserUI();
                
                // Show success message
                showToast('Login successful! Welcome back, ' + currentUser.first_name);
                
                // Navigate to home page
                navigateTo('home');
                
                // Initialize recently viewed
                updateRecentlyViewed();
                
                // If admin, navigate to admin dashboard
                if (currentUser.role === 'admin') {
                    navigateTo('admin');
                }
            } else {
                showToast('Invalid email or password');
            }
            
            return false;
        }

        async function handleRegister(event) {
            event.preventDefault();
            
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // Check if passwords match
            if (password !== confirmPassword) {
                showToast('Passwords do not match');
                return false;
            }
            
            // Check if email is already in use
            if (mockUsers.some(u => u.email === email)) {
                showToast('Email already in use');
                return false;
            }
            
            // Create new user
            const newUser = {
                id: mockUsers.length + 1,
                first_name: firstName,
                last_name: lastName,
                email: email,
                password: password, // In a real app, this would be hashed
                role: 'customer',
                last_active: new Date().toISOString(),
                created_at: new Date().toISOString()
            };
            
            // Add to mock users
            mockUsers.push(newUser);
            
            // Log in the new user (exclude password from stored user)
            const { password: _, ...userInfo } = newUser;
            currentUser = userInfo;
            
            // Store in localStorage
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            // Update UI
            updateUserUI();
            
            // Show success message
            showToast('Registration successful! Welcome to ShopSmart!');
            
            // Navigate to home page
            navigateTo('home');
            
            return false;
        }

        function logout() {
            // Clear local storage
            localStorage.removeItem('currentUser');
            
            // Reset state
            currentUser = null;
            recentlyViewedProducts = [];
            cartItems = [];
            
            // Update UI
            updateUserUI();
            updateRecentlyViewed();
            
            showToast('Logged out successfully');
            navigateTo('home');
        }

        function updateUserUI() {
            const userSection = document.getElementById('userSection');
            const mobileUserLinks = document.getElementById('mobileUserLinks');
            
            if (currentUser) {
                userSection.innerHTML = `
                    <div class="relative">
                        <button id="userDropdownBtn" class="flex items-center space-x-2 focus:outline-none">
                            <div class="w-10 h-10 rounded-full overflow-hidden bg-primary flex items-center justify-center text-white">
                                <span>${currentUser.first_name.charAt(0)}${currentUser.last_name.charAt(0)}</span>
                            </div>
                            <span class="hidden md:block text-gray-800 dark:text-white">${currentUser.first_name}</span>
                            <i class="fas fa-chevron-down text-xs ml-1 text-gray-500 dark:text-gray-400"></i>
                        </button>
                        <div id="userDropdown" class="absolute right-0 mt-3 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-lg py-2 hidden z-10 border border-gray-200 dark:border-gray-700">
                            <div class="px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                                <p class="text-sm font-medium text-gray-900 dark:text-white">${currentUser.first_name} ${currentUser.last_name}</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400 truncate">${currentUser.email}</p>
                            </div>
                            ${currentUser.role === 'admin' ? '<a href="#" onclick="navigateTo(\'admin\')" class="block px-4 py-2 text-gray-800 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700"><i class="fas fa-tachometer-alt mr-2"></i> Admin Dashboard</a>' : ''}
                            <a href="#" onclick="navigateTo('profile')" class="block px-4 py-2 text-gray-800 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700">
                                <i class="fas fa-user mr-2"></i> My Profile
                            </a>
                            <a href="#" onclick="navigateTo('recommendations')" class="block px-4 py-2 text-gray-800 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700">
                                <i class="fas fa-heart mr-2"></i> My Recommendations
                            </a>
                            <div class="border-t border-gray-200 dark:border-gray-700 mt-1 pt-1">
                                <a href="#" onclick="logout()" class="block px-4 py-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20">
                                    <i class="fas fa-sign-out-alt mr-2"></i> Logout
                                </a>
                            </div>
                        </div>
                    </div>
                `;
                
                // Update mobile menu
                if (mobileUserLinks) {
                    mobileUserLinks.innerHTML = `
                        <a href="#" class="block py-2 px-4 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md" onclick="navigateTo('profile'); toggleMobileMenu()">
                            <i class="fas fa-user mr-2"></i> My Profile
                        </a>
                        ${currentUser.role === 'admin' ? 
                            `<a href="#" class="block py-2 px-4 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md" onclick="navigateTo('admin'); toggleMobileMenu()">
                                <i class="fas fa-tachometer-alt mr-2"></i> Admin Dashboard
                            </a>` : ''
                        }
                        <a href="#" class="block py-2 px-4 text-red-500 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md" onclick="logout(); toggleMobileMenu()">
                            <i class="fas fa-sign-out-alt mr-2"></i> Logout
                        </a>
                    `;
                }
                
                // Add dropdown toggle functionality
                document.getElementById('userDropdownBtn').addEventListener('click', toggleUserDropdown);
                
                // Close dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('#userDropdownBtn') && !e.target.closest('#userDropdown')) {
                        const dropdown = document.getElementById('userDropdown');
                        if (dropdown) dropdown.classList.add('hidden');
                    }
                });
            } else {
                userSection.innerHTML = `
                    <button onclick="navigateTo('login')" class="btn-primary py-2 px-4 rounded-full text-base transition-all duration-200">Login</button>
                `;
                
                // Update mobile menu
                if (mobileUserLinks) {
                    mobileUserLinks.innerHTML = `
                        <a href="#" class="block py-2 px-4 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md" onclick="navigateTo('login'); toggleMobileMenu()">
                            <i class="fas fa-sign-in-alt mr-2"></i> Login
                        </a>
                        <a href="#" class="block py-2 px-4 text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md" onclick="navigateTo('register'); toggleMobileMenu()">
                            <i class="fas fa-user-plus mr-2"></i> Register
                        </a>
                    `;
                }
            }
        }

        function toggleUserDropdown() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('hidden');
        }

        // Product Functions
        async function applyFilters() {
            minPriceFilter = document.getElementById('minPrice').value ? parseFloat(document.getElementById('minPrice').value) : null;
            maxPriceFilter = document.getElementById('maxPrice').value ? parseFloat(document.getElementById('maxPrice').value) : null;
            
            const productsContainer = document.getElementById('productsContainer');
            productsContainer.innerHTML = '<div class="col-span-full flex flex-col items-center justify-center py-12"><div class="loader"></div><p class="mt-4 text-gray-600 dark:text-gray-400">Loading products...</p></div>';
            
            try {
                // Apply client-side filtering to mock data
                let filteredMockProducts = [...mockProducts];
                
                if (currentCategory !== 'all') {
                    filteredMockProducts = filteredMockProducts.filter(p => p.category === currentCategory);
                }
                
                if (minPriceFilter !== null) {
                    filteredMockProducts = filteredMockProducts.filter(p => p.price >= minPriceFilter);
                }
                
                if (maxPriceFilter !== null) {
                    filteredMockProducts = filteredMockProducts.filter(p => p.price <= maxPriceFilter);
                }
                
                if (searchQuery) {
                    const query = searchQuery.toLowerCase();
                    filteredMockProducts = filteredMockProducts.filter(p => 
                        p.name.toLowerCase().includes(query) || 
                        p.brand.toLowerCase().includes(query) || 
                        p.category.toLowerCase().includes(query) ||
                        p.description.toLowerCase().includes(query)
                    );
                }
                
                // Apply sorting
                switch (currentSortOption) {
                    case 'price_low':
                        filteredMockProducts.sort((a, b) => a.price - b.price);
                        break;
                    case 'price_high':
                        filteredMockProducts.sort((a, b) => b.price - a.price);
                        break;
                    case 'rating':
                        filteredMockProducts.sort((a, b) => b.rating - a.rating);
                        break;
                    case 'newest':
                        // We don't have date info, so just reverse the order
                        filteredMockProducts.reverse();
                        break;
                    default: // popularity
                        filteredMockProducts.sort((a, b) => b.reviews_count - a.reviews_count);
                }
                
                // Paginate
                const start = (currentPage - 1) * itemsPerPage;
                const paginatedProducts = filteredMockProducts.slice(start, start + itemsPerPage);
                
                // Add a slight delay to simulate network request
                setTimeout(() => {
                    displayProducts(paginatedProducts, filteredMockProducts.length);
                }, 500);
            } catch (error) {
                console.error('Error loading products:', error);
                productsContainer.innerHTML = '<div class="col-span-full text-center py-8"><p class="text-red-500">Failed to load products</p></div>';
            }
        }

        function displayProducts(filteredProducts, totalProducts) {
            const productsContainer = document.getElementById('productsContainer');
            productsContainer.innerHTML = '';
            
            if (filteredProducts.length === 0) {
                productsContainer.innerHTML = '<div class="col-span-full text-center py-12"><i class="fas fa-search text-4xl text-gray-400 mb-4"></i><p class="text-gray-600 dark:text-gray-400">No products found matching your criteria</p><button onclick="resetFilters()" class="mt-4 text-primary hover:text-primary-dark">Reset Filters</button></div>';
                return;
            }
            
            filteredProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'card product-card cursor-pointer transition-all duration-300 transform hover:-translate-y-2';
                productCard.setAttribute('data-id', product.id);
                
                if (viewMode === 'grid') {
                    productCard.innerHTML = `
                        <div class="relative overflow-hidden">
                            <img src="${product.image}" alt="${product.name}" class="product-image w-full h-48 object-cover rounded-t-lg transition-transform duration-500">
                            <span class="absolute top-2 right-2 bg-white dark:bg-gray-800 text-primary px-2 py-1 rounded-full text-xs font-medium shadow-md">${product.category}</span>
                            <div class="hover-overlay">
                                <button onclick="viewProductDetails(${product.id})" class="bg-white/90 dark:bg-gray-800/90 text-primary py-2 px-6 rounded-full hover:bg-white dark:hover:bg-gray-800 transition-all duration-200 shadow-md">
                                    View Details
                                </button>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="flex items-start justify-between mb-2">
                                <h3 class="font-bold text-lg truncate flex-grow">${product.name}</h3>
                                <span class="font-bold text-lg ml-2">$${product.price.toFixed(2)}</span>
                            </div>
                            <p class="text-gray-600 dark:text-gray-400 text-sm mb-3">${product.brand}</p>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="star-rating mr-2">
                                        ${getStarRating(product.rating)}
                                    </div>
                                    <span class="text-xs text-gray-600 dark:text-gray-400">(${product.reviews_count})</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="event.stopPropagation(); addToWishlist(${product.id})" class="p-2 text-gray-500 hover:text-red-500 transition-colors duration-200" title="Add to Wishlist">
                                        <i class="far fa-heart"></i>
                                    </button>
                                    <button onclick="event.stopPropagation(); addToCart(${product.id})" class="p-2 text-gray-500 hover:text-primary transition-colors duration-200" title="Add to Cart">
                                        <i class="fas fa-shopping-cart"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    productCard.className = 'card product-card cursor-pointer flex transition-all duration-300 transform hover:-translate-y-1';
                    productCard.innerHTML = `
                        <div class="relative w-32 h-32 md:w-48 md:h-48">
                            <img src="${product.image}" alt="${product.name}" class="product-image w-full h-full object-cover rounded-l-lg transition-transform duration-500">
                            <div class="hover-overlay rounded-l-lg">
                                <button onclick="viewProductDetails(${product.id})" class="bg-white/90 dark:bg-gray-800/90 text-primary py-1 px-3 rounded-full text-sm hover:bg-white dark:hover:bg-gray-800 transition-all duration-200 shadow-md">
                                    Details
                                </button>
                            </div>
                        </div>
                        <div class="p-4 flex-1 flex flex-col">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <h3 class="font-bold mb-1">${product.name}</h3>
                                    <p class="text-gray-600 dark:text-gray-400 text-sm">${product.brand}</p>
                                </div>
                                <span class="bg-gray-200 dark:bg-gray-700 text-primary px-2 py-1 rounded-full text-xs font-medium">${product.category}</span>
                            </div>
                            <p class="text-gray-600 dark:text-gray-400 text-sm mb-2 line-clamp-2">${product.description}</p>
                            <div class="flex items-center mt-auto">
                                <div class="star-rating mr-2 text-sm">
                                    ${getStarRating(product.rating)}
                                </div>
                                <span class="text-xs text-gray-600 dark:text-gray-400">(${product.reviews_count})</span>
                            </div>
                            <div class="flex justify-between items-center mt-3">
                                <span class="font-bold text-lg">$${product.price.toFixed(2)}</span>
                                <div class="flex space-x-2">
                                    <button onclick="event.stopPropagation(); addToWishlist(${product.id})" class="p-2 text-gray-500 hover:text-red-500 transition-colors duration-200" title="Add to Wishlist">
                                        <i class="far fa-heart"></i>
                                    </button>
                                    <button onclick="event.stopPropagation(); addToCart(${product.id})" class="p-2 text-gray-500 hover:text-primary transition-colors duration-200" title="Add to Cart">
                                        <i class="fas fa-shopping-cart"></i>
                                    </button>
                                    <button onclick="viewProductDetails(${product.id})" class="btn-primary py-1 px-3 rounded-full text-sm">
                                        View
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                productsContainer.appendChild(productCard);
                
                // Add click event to view product
                productCard.addEventListener('click', (e) => {
                    if (!e.target.closest('button')) {
                        viewProductDetails(product.id);
                    }
                });
            });
            
            // Show or hide load more button
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            const totalPages = Math.ceil(totalProducts / itemsPerPage);
            
            if (currentPage < totalPages) {
                loadMoreBtn.classList.remove('hidden');
            } else {
                loadMoreBtn.classList.add('hidden');
            }
        }

        function resetFilters() {
            // Reset all filter values
            document.getElementById('minPrice').value = '';
            document.getElementById('maxPrice').value = '';
            document.getElementById('sortOption').value = 'popularity';
            
            // Reset state variables
            currentCategory = 'all';
            currentPage = 1;
            currentSortOption = 'popularity';
            minPriceFilter = null;
            maxPriceFilter = null;
            searchQuery = '';
            
            // Clear search input
            document.getElementById('searchInput').value = '';
            
            // Update active category pill
            document.querySelectorAll('.category-pill').forEach(pill => {
                pill.classList.remove('active');
                if (pill.textContent.toLowerCase().includes('all products')) {
                    pill.classList.add('active');
                }
            });
            
            // Apply filters to reload products
            applyFilters();
        }

        function getStarRating(rating) {
            const fullStars = Math.floor(rating);
            const halfStar = rating % 1 >= 0.5;
            const emptyStars = 5 - fullStars - (halfStar ? 1 : 0);
            
            let stars = '';
            
            for (let i = 0; i < fullStars; i++) {
                stars += '<i class="fas fa-star"></i>';
            }
            
            if (halfStar) {
                stars += '<i class="fas fa-star-half-alt"></i>';
            }
            
            for (let i = 0; i < emptyStars; i++) {
                stars += '<i class="far fa-star"></i>';
            }
            
            return stars;
        }

        async function viewProductDetails(productId) {
            try {
                // Find the product in mock data
                const product = mockProducts.find(p => p.id === productId);
                
                if (!product) {
                    showToast('Product not found');
                    return;
                }
                
                // Add to recently viewed if logged in
                if (currentUser) {
                    addToRecentlyViewed(product);
                    // Record interaction for recommendation engine
                    recordInteraction(productId, 'view');
                }
                
                // Show product details modal
                const modal = document.getElementById('productDetailsModal');
                const content = document.getElementById('productDetailsContent');
                
                content.innerHTML = `
                    <div class="flex flex-col md:flex-row gap-8">
                        <div class="md:w-1/2">
                            <div class="relative rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800">
                                <img src="${product.image}" alt="${product.name}" class="w-full h-64 md:h-80 object-cover rounded-lg transition-transform duration-500 hover:scale-105">
                            </div>
                            <div class="grid grid-cols-4 gap-2 mt-4">
                                <div class="aspect-square rounded-md overflow-hidden cursor-pointer bg-gray-100 dark:bg-gray-800">
                                    <img src="${product.image}" alt="Thumbnail 1" class="w-full h-full object-cover hover:opacity-80 transition-opacity">
                                </div>
                                <div class="aspect-square rounded-md overflow-hidden cursor-pointer bg-gray-100 dark:bg-gray-800">
                                    <img src="${product.image}" alt="Thumbnail 2" class="w-full h-full object-cover hover:opacity-80 transition-opacity">
                                </div>
                                <div class="aspect-square rounded-md overflow-hidden cursor-pointer bg-gray-100 dark:bg-gray-800">
                                    <img src="${product.image}" alt="Thumbnail 3" class="w-full h-full object-cover hover:opacity-80 transition-opacity">
                                </div>
                                <div class="aspect-square rounded-md overflow-hidden cursor-pointer bg-gray-100 dark:bg-gray-800">
                                    <img src="${product.image}" alt="Thumbnail 4" class="w-full h-full object-cover hover:opacity-80 transition-opacity">
                                </div>
                            </div>
                        </div>
                        <div class="md:w-1/2">
                            <span class="bg-primary bg-opacity-10 text-primary px-3 py-1 rounded-full text-sm">${product.category}</span>
                            <h2 class="text-2xl font-bold mt-2 mb-1">${product.name}</h2>
                            <p class="text-gray-600 dark:text-gray-400 mb-3">${product.brand}</p>
                            
                            <div class="flex items-center mb-2">
                                <div class="star-rating mr-2">
                                    ${getStarRating(product.rating)}
                                </div>
                                <span class="text-sm text-gray-600 dark:text-gray-400">(${product.reviews_count} reviews)</span>
                            </div>
                            
                            <p class="text-3xl font-bold text-primary mb-6">$${product.price.toFixed(2)}</p>
                            
                            <div class="p-5 bg-gray-100 dark:bg-gray-800 rounded-lg mb-6">
                                <h3 class="font-bold mb-3">Product Description</h3>
                                <p class="text-gray-600 dark:text-gray-400">${product.description}</p>
                            </div>
                            
                            <div class="mb-6 grid grid-cols-2 gap-4">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-500 flex items-center justify-center mr-3">
                                        <i class="fas fa-tag"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Category</p>
                                        <p class="font-semibold">${product.category.charAt(0).toUpperCase() + product.category.slice(1)}</p>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-10 h-10 rounded-full bg-green-100 dark:bg-green-900 text-green-500 flex items-center justify-center mr-3">
                                        <i class="fas fa-box"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">In Stock</p>
                                        <p class="font-semibold">${product.stock} units</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="border-t border-gray-200 dark:border-gray-700 pt-6 mb-6">
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                                    <button onclick="addToCart(${product.id}, true)" class="btn-primary py-3 px-4 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-shopping-cart mr-2"></i> Add to Cart
                                    </button>
                                    <button onclick="addToWishlist(${product.id})" class="bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white py-3 px-4 rounded-lg flex items-center justify-center hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                                        <i class="far fa-heart mr-2"></i> Add to Wishlist
                                    </button>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900 text-indigo-500 flex items-center justify-center mr-3">
                                        <i class="fas fa-truck"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium">Free Shipping</p>
                                        <p class="text-xs text-gray-600 dark:text-gray-400">For orders over $50</p>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900 text-orange-500 flex items-center justify-center mr-3">
                                        <i class="fas fa-shield-alt"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium">1 Year Warranty</p>
                                        <p class="text-xs text-gray-600 dark:text-gray-400">Full coverage</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-10">
                        <h3 class="text-xl font-bold mb-6">You May Also Like</h3>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4" id="similarProductsGrid">
                            <div class="col-span-full flex flex-col items-center justify-center py-8">
                                <div class="loader"></div>
                                <p class="mt-4 text-gray-600 dark:text-gray-400">Loading similar products...</p>
                            </div>
                        </div>
                    </div>
                `;
                
                modal.style.display = 'block';
                
                // Load similar products
                loadSimilarProducts(productId);
            } catch (error) {
                console.error('Error loading product details:', error);
                showToast('Error loading product details');
            }
        }

        async function loadSimilarProducts(productId) {
            try {
                const product = mockProducts.find(p => p.id === productId);
                
                if (!product) {
                    document.getElementById('similarProductsGrid').innerHTML = '<div class="col-span-full text-center py-8"><p class="text-gray-600 dark:text-gray-400">Product not found</p></div>';
                    return;
                }
                
                // Get similar products (same category)
                const similarProducts = mockProducts
                    .filter(p => p.id !== productId && p.category === product.category)
                    .slice(0, 4);
                
                const similarProductsGrid = document.getElementById('similarProductsGrid');
                
                if (similarProducts.length === 0) {
                    similarProductsGrid.innerHTML = '<div class="col-span-full text-center py-8"><p class="text-gray-600 dark:text-gray-400">No similar products found</p></div>';
                    return;
                }
                
                // Add a slight delay to simulate network request
                setTimeout(() => {
                    similarProductsGrid.innerHTML = similarProducts.map(p => `
                        <div class="card cursor-pointer transition-all duration-300 transform hover:-translate-y-1" onclick="viewProductDetails(${p.id})">
                            <div class="relative overflow-hidden">
                                <img src="${p.image}" alt="${p.name}" class="w-full h-32 object-cover rounded-t-lg hover:scale-105 transition-transform duration-300">
                            </div>
                            <div class="p-4">
                                <h4 class="font-bold text-sm line-clamp-1">${p.name}</h4>
                                <div class="flex justify-between items-center mt-2">
                                    <p class="text-primary font-semibold">$${p.price.toFixed(2)}</p>
                                    <div class="star-rating text-xs">
                                        ${getStarRating(p.rating)}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('');
                }, 500);
            } catch (error) {
                console.error('Error loading similar products:', error);
                document.getElementById('similarProductsGrid').innerHTML = '<div class="col-span-full text-center py-8"><p class="text-red-500">Error loading similar products</p></div>';
            }
        }

        function closeProductDetailsModal() {
            const modal = document.getElementById('productDetailsModal');
            modal.style.display = 'none';
        }

        async function addToCart(productId, showCheckout = false) {
            if (!currentUser) {
                showToast('Please log in to add items to your cart');
                navigateTo('login');
                return;
            }
            
            try {
                // Find product in mock data
                const product = mockProducts.find(p => p.id === productId);
                
                if (!product) {
                    showToast('Product not found');
                    return;
                }
                
                // Check if product is already in cart
                const existingItemIndex = cartItems.findIndex(item => item.product_id === productId);
                
                if (existingItemIndex !== -1) {
                    // Increment quantity
                    cartItems[existingItemIndex].quantity += 1;
                } else {
                    // Add to cart
                    cartItems.push({
                        product_id: productId,
                        quantity: 1,
                        price: product.price
                    });
                }
                
                // Record interaction
                await recordInteraction(productId, 'cart');
                
                showToast(`Added ${product.name} to your cart`);
                
                // If showCheckout is true, show checkout modal
                if (showCheckout) {
                    openCheckoutModal();
                }
            } catch (error) {
                console.error('Error adding to cart:', error);
                showToast('Error adding product to cart');
            }
        }

        function openCheckoutModal() {
            if (!currentUser) {
                showToast('Please log in to checkout');
                navigateTo('login');
                return;
            }
            
            if (cartItems.length === 0) {
                showToast('Your cart is empty');
                return;
            }
            
            // Calculate totals
            const subtotal = cartItems.reduce((total, item) => {
                return total + (item.price * item.quantity);
            }, 0);
            
            const shipping = subtotal >= 50 ? 0 : 5.99;
            const tax = subtotal * 0.08;
            const total = subtotal + shipping + tax;
            
            // Populate checkout items
            const checkoutItems = document.getElementById('checkoutItems');
            checkoutItems.innerHTML = cartItems.map(item => {
                const product = mockProducts.find(p => p.id === item.product_id);
                return `
                    <div class="flex items-center mb-4 pb-4 border-b border-gray-200 dark:border-gray-700">
                        <img src="${product.image}" alt="${product.name}" class="w-16 h-16 object-cover rounded mr-4">
                        <div class="flex-grow">
                            <h4 class="font-medium">${product.name}</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Qty: ${item.quantity}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-bold">$${(item.price * item.quantity).toFixed(2)}</p>
                        </div>
                    </div>
                `;
            }).join('');
            
            // Update totals
            document.getElementById('checkoutSubtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('checkoutShipping').textContent = shipping === 0 ? 'FREE' : `$${shipping.toFixed(2)}`;
            document.getElementById('checkoutTax').textContent = `$${tax.toFixed(2)}`;
            document.getElementById('checkoutTotal').textContent = `$${total.toFixed(2)}`;
            
            // Pre-fill shipping information if available
            if (currentUser) {
                document.getElementById('shippingName').value = `${currentUser.first_name} ${currentUser.last_name}`;
                document.getElementById('shippingPhone').value = currentUser.phone || '';
            }
            
            // Show modal
            document.getElementById('checkoutModal').style.display = 'block';
        }

        function closeCheckoutModal() {
            document.getElementById('checkoutModal').style.display = 'none';
        }

        function completeOrder() {
            if (!currentUser) {
                showToast('Please log in to complete your order');
                closeCheckoutModal();
                navigateTo('login');
                return;
            }
            
            if (cartItems.length === 0) {
                showToast('Your cart is empty');
                closeCheckoutModal();
                return;
            }
            
            // Check if shipping info is filled
            const shippingName = document.getElementById('shippingName').value;
            const shippingPhone = document.getElementById('shippingPhone').value;
            const shippingAddress = document.getElementById('shippingAddress').value;
            const shippingCity = document.getElementById('shippingCity').value;
            const shippingZip = document.getElementById('shippingZip').value;
            
            if (!shippingName || !shippingPhone || !shippingAddress || !shippingCity || !shippingZip) {
                showToast('Please fill in all shipping information');
                return;
            }
            
            // Calculate total
            const subtotal = cartItems.reduce((total, item) => {
                return total + (item.price * item.quantity);
            }, 0);
            
            const shipping = subtotal >= 50 ? 0 : 5.99;
            const tax = subtotal * 0.08;
            const total = subtotal + shipping + tax;
            
            // Create new order
            const newOrder = {
                id: Math.max(...mockOrders.map(o => o.id)) + 1,
                user_id: currentUser.id,
                items: cartItems.map(item => ({
                    product_id: item.product_id,
                    quantity: item.quantity,
                    price: item.price
                })),
                total: total,
                status: 'pending',
                date: new Date().toISOString(),
                shipping: {
                    name: shippingName,
                    phone: shippingPhone,
                    address: shippingAddress,
                    city: shippingCity,
                    zip: shippingZip
                }
            };
            
            // Add to orders
            mockOrders.unshift(newOrder);
            
            // Clear cart
            cartItems = [];
            
            // Close modal
            closeCheckoutModal();
            
            // Show success message
            showToast('Order placed successfully!');
            
            // If on profile page, update orders
            if (document.getElementById('profilePage').classList.contains('active-page')) {
                initUserProfile();
            }
        }

        function addToWishlist(productId) {
            if (!currentUser) {
                showToast('Please log in to add items to your wishlist');
                navigateTo('login');
                return;
            }
            
            try {
                // Find user's wishlist
                let userWishlist = mockWishlist.find(w => w.user_id === currentUser.id);
                
                // Create wishlist if it doesn't exist
                if (!userWishlist) {
                    userWishlist = {
                        user_id: currentUser.id,
                        products: []
                    };
                    mockWishlist.push(userWishlist);
                }
                
                // Check if product is already in wishlist
                if (userWishlist.products.includes(productId)) {
                    showToast('Product is already in your wishlist');
                    return;
                }
                
                // Add product to wishlist
                userWishlist.products.push(productId);
                
                // Update UI if on wishlist page
                if (document.getElementById('wishlistTab').classList.contains('active')) {
                    loadWishlist();
                }
                
                // Get product details
                const product = mockProducts.find(p => p.id === productId);
                showToast(`Added ${product.name} to your wishlist`);
            } catch (error) {
                console.error('Error adding to wishlist:', error);
                showToast('Error adding product to wishlist');
            }
        }

        // Filter and Sort Functions
        function filterByCategory(category) {
            currentCategory = category;
            currentPage = 1;
            
            // Update active category pill
            document.querySelectorAll('.category-pill').forEach(pill => {
                pill.classList.remove('active');
            });
            
            document.querySelectorAll('.category-pill').forEach(pill => {
                if (pill.textContent.toLowerCase().includes(category)) {
                    pill.classList.add('active');
                }
            });
            
            applyFilters();
        }

        function sortProducts() {
            currentSortOption = document.getElementById('sortOption').value;
            currentPage = 1;
            applyFilters();
        }

        function searchProducts() {
            searchQuery = document.getElementById('searchInput').value.trim();
            currentPage = 1;
            
            if (searchQuery) {
                navigateTo('home');
                applyFilters();
            }
        }

        // Add event listener for search on Enter key
        document.getElementById('searchInput').addEventListener('keyup', function(event) {
            if (event.key === 'Enter') {
                searchProducts();
            }
        });

        function toggleViewMode() {
            viewMode = viewMode === 'grid' ? 'list' : 'grid';
            
            // Update view toggle button
            const viewIcon = document.getElementById('viewIcon');
            const viewModeText = document.getElementById('viewMode');
            
            if (viewMode === 'grid') {
                viewIcon.className = 'fas fa-th-large mr-2';
                viewModeText.textContent = 'Grid View';
            } else {
                viewIcon.className = 'fas fa-list mr-2';
                viewModeText.textContent = 'List View';
            }
            
            // Re-apply filters to update the display
            applyFilters();
        }

        function loadMoreProducts() {
            currentPage++;
            applyFilters();
        }

        // Recommendation System Functions
        function addToRecentlyViewed(product) {
            // Check if product is already in recently viewed
            const existingIndex = recentlyViewedProducts.findIndex(p => p.id === product.id);
            
            if (existingIndex !== -1) {
                // Remove from current position
                recentlyViewedProducts.splice(existingIndex, 1);
            }
            
            // Add to the beginning of the array
            recentlyViewedProducts.unshift(product);
            
            // Keep only the last 4 products
            if (recentlyViewedProducts.length > 4) {
                recentlyViewedProducts = recentlyViewedProducts.slice(0, 4);
            }
            
            // Update recently viewed section
            updateRecentlyViewed();
        }

        function updateRecentlyViewed() {
            const container = document.getElementById('recentlyViewedContainer');
            
            if (recentlyViewedProducts.length === 0) {
                container.innerHTML = '<div class="col-span-full text-center py-12"><i class="far fa-eye text-4xl text-gray-400 mb-4"></i><p class="text-gray-600 dark:text-gray-400">No recently viewed products</p><p class="mt-2 text-sm text-gray-600 dark:text-gray-400">Products you view will appear here for easy access</p></div>';
                return;
            }
            
            container.innerHTML = '';
            
            recentlyViewedProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'card product-card cursor-pointer transition-all duration-300 transform hover:-translate-y-2';
                productCard.innerHTML = `
                    <div class="relative overflow-hidden">
                        <img src="${product.image}" alt="${product.name}" class="product-image w-full h-48 object-cover rounded-t-lg transition-transform duration-500">
                        <span class="absolute top-2 right-2 bg-white dark:bg-gray-800 text-primary px-2 py-1 rounded-full text-xs font-medium shadow-md">${product.category}</span>
                        <div class="hover-overlay">
                            <button onclick="viewProductDetails(${product.id})" class="bg-white/90 dark:bg-gray-800/90 text-primary py-2 px-6 rounded-full hover:bg-white dark:hover:bg-gray-800 transition-all duration-200 shadow-md">
                                View Details
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="flex items-start justify-between mb-2">
                            <h3 class="font-bold truncate flex-grow">${product.name}</h3>
                            <span class="font-bold ml-2">$${product.price.toFixed(2)}</span>
                        </div>
                        <p class="text-gray-600 dark:text-gray-400 text-sm mb-3">${product.brand}</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="star-rating mr-2">
                                    ${getStarRating(product.rating)}
                                </div>
                                <span class="text-xs text-gray-600 dark:text-gray-400">(${product.reviews_count})</span>
                            </div>
                            <button onclick="viewProductDetails(${product.id})" class="btn-primary py-1 px-3 rounded-full text-sm">
                                View
                            </button>
                        </div>
                    </div>
                `;
                
                container.appendChild(productCard);
                
                // Add click event
                productCard.addEventListener('click', (e) => {
                    if (!e.target.closest('button')) {
                        viewProductDetails(product.id);
                    }
                });
            });
        }

        async function recordInteraction(productId, interactionType) {
            if (!currentUser) return;
            
            try {
                console.log(`Recorded ${interactionType} interaction for product ${productId}`);
                // In a real app, this would be an API call to record the interaction
            } catch (error) {
                console.error('Error recording interaction:', error);
            }
        }

        async function loadRecommendations() {
            // Show loading states
            document.getElementById('personalizedRecommendations').innerHTML = '<div class="col-span-full flex flex-col items-center justify-center py-12"><div class="loader"></div><p class="mt-4 text-gray-600 dark:text-gray-400">Generating personalized recommendations...</p></div>';
            document.getElementById('similarProductsContainer').innerHTML = '<div class="col-span-full flex flex-col items-center justify-center py-12"><div class="loader"></div><p class="mt-4 text-gray-600 dark:text-gray-400">Analyzing your browsing history...</p></div>';
            document.getElementById('collaborativeRecommendations').innerHTML = '<div class="col-span-full flex flex-col items-center justify-center py-12"><div class="loader"></div><p class="mt-4 text-gray-600 dark:text-gray-400">Finding products that similar users liked...</p></div>';
            
            // If not logged in, show login message and popular products
            if (!currentUser) {
                document.getElementById('personalizedRecommendations').innerHTML = `
                    <div class="col-span-full mb-8">
                        <div class="bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg flex items-center">
                            <div class="mr-6 hidden md:block">
                                <i class="fas fa-user-circle text-blue-500 text-4xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg mb-1">Get Personalized Recommendations</h3>
                                <p class="text-gray-600 dark:text-gray-400 mb-4">Sign in to see recommendations tailored just for you based on your browsing history and preferences.</p>
                                <button onclick="navigateTo('login')" class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-6 rounded-lg transition-colors duration-200">
                                    Sign In Now
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                try {
                    // Sort by popularity for not logged in users
                    const popularProducts = [...mockProducts].sort((a, b) => b.reviews_count - a.reviews_count).slice(0, 8);
                    
                    // Add a slight delay to simulate network request
                    setTimeout(() => {
                        displayRecommendedProducts(popularProducts);
                    }, 800);
                } catch (error) {
                    console.error('Error displaying products:', error);
                    document.getElementById('personalizedRecommendations').innerHTML += '<div class="col-span-full text-center py-8"><p class="text-red-500">Failed to load popular products</p></div>';
                }
                
                // Clear other sections
                setTimeout(() => {
                    document.getElementById('similarProductsContainer').innerHTML = '<div class="col-span-full text-center py-12"><i class="far fa-clock text-4xl text-gray-400 mb-4"></i><p class="text-gray-600 dark:text-gray-400">Sign in and browse products to see recommendations here</p></div>';
                    document.getElementById('collaborativeRecommendations').innerHTML = '<div class="col-span-full text-center py-12"><i class="fas fa-users text-4xl text-gray-400 mb-4"></i><p class="text-gray-600 dark:text-gray-400">Sign in to see what similar users are viewing</p></div>';
                }, 800);
                return;
            }
            
            // For logged-in users, simulate personalized recommendations
            try {
                // Add a slight delay to simulate network request
                setTimeout(() => {
                    // Simulate personalized recommendations based on user behavior
                    let personalizedProducts = [];
                    
                    if (recentlyViewedProducts.length > 0) {
                        // Find categories of recently viewed products
                        const viewedCategories = recentlyViewedProducts.map(p => p.category);
                        const uniqueCategories = [...new Set(viewedCategories)];
                        
                        // Get products from those categories, but not the ones already viewed
                        const viewedIds = recentlyViewedProducts.map(p => p.id);
                        personalizedProducts = mockProducts.filter(p => 
                            !viewedIds.includes(p.id) && 
                            uniqueCategories.includes(p.category)
                        ).slice(0, 8);
                    } else {
                        // If no recent views, recommend top-rated products
                        personalizedProducts = [...mockProducts]
                            .sort((a, b) => b.rating - a.rating)
                            .slice(0, 8);
                    }
                    
                    displayRecommendedProducts(personalizedProducts);
                    
                    // Load similar products based on recently viewed if available
                    if (recentlyViewedProducts.length > 0) {
                        // Get products similar to the most recently viewed
                        const recentCategory = recentlyViewedProducts[0].category;
                        const similarProducts = mockProducts.filter(p => 
                            p.id !== recentlyViewedProducts[0].id && 
                            p.category === recentCategory
                        ).slice(0, 8);
                        
                        displaySimilarProducts(similarProducts);
                    } else {
                        document.getElementById('similarProductsContainer').innerHTML = '<div class="col-span-full text-center py-12"><i class="far fa-eye text-4xl text-gray-400 mb-4"></i><p class="text-gray-600 dark:text-gray-400">Browse more products to see recommendations here</p></div>';
                    }
                    
                    // Simulate collaborative recommendations
                    // For demo, just use the most reviewed products
                    const collaborativeProducts = [...mockProducts]
                        .sort((a, b) => b.reviews_count - a.reviews_count)
                        .slice(0, 8);
                    
                    displayCollaborativeRecommendations(collaborativeProducts);
                    
                    // Update recommendation status
                    document.getElementById('recommendationStatus').textContent = 'Last updated: ' + new Date().toLocaleTimeString();
                }, 1200);
            } catch (error) {
                console.error('Error loading recommendations:', error);
                document.getElementById('personalizedRecommendations').innerHTML = '<div class="col-span-full text-center py-8"><p class="text-red-500">Failed to load recommendations</p></div>';
                document.getElementById('similarProductsContainer').innerHTML = '<div class="col-span-full text-center py-8"><p class="text-red-500">Failed to load similar products</p></div>';
                document.getElementById('collaborativeRecommendations').innerHTML = '<div class="col-span-full text-center py-8"><p class="text-red-500">Failed to load collaborative recommendations</p></div>';
            }
        }

        function displayRecommendedProducts(recommendedProducts) {
            const container = document.getElementById('personalizedRecommendations');
            
            if (!currentUser) {
                // Popular products are displayed after login message
                container.innerHTML += recommendedProducts.map(product => `
                    <div class="card product-card cursor-pointer transition-all duration-300 transform hover:-translate-y-2" onclick="viewProductDetails(${product.id})">
                        <div class="relative overflow-hidden">
                            <img src="${product.image}" alt="${product.name}" class="product-image w-full h-48 object-cover rounded-t-lg transition-transform duration-500">
                            <span class="absolute top-2 right-2 bg-white dark:bg-gray-800 text-primary px-2 py-1 rounded-full text-xs font-medium shadow-md">${product.category}</span>
                            <div class="hover-overlay">
                                <button onclick="viewProductDetails(${product.id})" class="bg-white/90 dark:bg-gray-800/90 text-primary py-2 px-6 rounded-full hover:bg-white dark:hover:bg-gray-800 transition-all duration-200 shadow-md">
                                    View Details
                                </button>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="flex items-start justify-between mb-2">
                                <h3 class="font-bold truncate flex-grow">${product.name}</h3>
                                <span class="font-bold ml-2">$${product.price.toFixed(2)}</span>
                            </div>
                            <p class="text-gray-600 dark:text-gray-400 text-sm mb-3">${product.brand}</p>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="star-rating mr-2">
                                        ${getStarRating(product.rating)}
                                    </div>
                                    <span class="text-xs text-gray-600 dark:text-gray-400">(${product.reviews_count})</span>
                                </div>
                                <button onclick="event.stopPropagation(); viewProductDetails(${product.id})" class="btn-primary py-1 px-3 rounded-full text-sm">
                                    View
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            } else {
                // If no recommendations, show a message
                if (recommendedProducts.length === 0) {
                    container.innerHTML = '<div class="col-span-full text-center py-12"><i class="fas fa-search text-4xl text-gray-400 mb-4"></i><p class="text-gray-600 dark:text-gray-400">No personalized recommendations available yet. Browse more products to get recommendations.</p></div>';
                    return;
                }
                
                // Display recommendations
                container.innerHTML = recommendedProducts.map(product => `
                    <div class="card product-card cursor-pointer transition-all duration-300 transform hover:-translate-y-2" onclick="viewProductDetails(${product.id})">
                        <div class="relative overflow-hidden">
                            ${Math.random() > 0.7 ? '<span class="recommendation-tag"><i class="fas fa-thumbs-up mr-1"></i> 95% Match</span>' : ''}
                            <img src="${product.image}" alt="${product.name}" class="product-image w-full h-48 object-cover rounded-t-lg transition-transform duration-500">
                            <span class="absolute top-2 right-2 bg-white dark:bg-gray-800 text-primary px-2 py-1 rounded-full text-xs font-medium shadow-md">${product.category}</span>
                            <div class="hover-overlay">
                                <button onclick="viewProductDetails(${product.id})" class="bg-white/90 dark:bg-gray-800/90 text-primary py-2 px-6 rounded-full hover:bg-white dark:hover:bg-gray-800 transition-all duration-200 shadow-md">
                                    View Details
                                </button>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="flex items-start justify-between mb-2">
                                <h3 class="font-bold truncate flex-grow">${product.name}</h3>
                                <span class="font-bold ml-2">$${product.price.toFixed(2)}</span>
                            </div>
                            <p class="text-gray-600 dark:text-gray-400 text-sm mb-3">${product.brand}</p>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="star-rating mr-2">
                                        ${getStarRating(product.rating)}
                                    </div>
                                    <span class="text-xs text-gray-600 dark:text-gray-400">(${product.reviews_count})</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="event.stopPropagation(); addToWishlist(${product.id})" class="p-2 text-gray-500 hover:text-red-500 transition-colors duration-200" title="Add to Wishlist">
                                        <i class="far fa-heart"></i>
                                    </button>
                                    <button onclick="event.stopPropagation(); addToCart(${product.id})" class="p-2 text-gray-500 hover:text-primary transition-colors duration-200" title="Add to Cart">
                                        <i class="fas fa-shopping-cart"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function displaySimilarProducts(similarProducts) {
            const container = document.getElementById('similarProductsContainer');
            
            if (similarProducts.length === 0) {
                container.innerHTML = '<div class="col-span-full text-center py-12"><i class="fas fa-search text-4xl text-gray-400 mb-4"></i><p class="text-gray-600 dark:text-gray-400">No similar products found. Try viewing more products.</p></div>';
                return;
            }
            
            container.innerHTML = similarProducts.map(product => `
                <div class="card product-card cursor-pointer transition-all duration-300 transform hover:-translate-y-2" onclick="viewProductDetails(${product.id})">
                    <div class="relative overflow-hidden">
                        <img src="${product.image}" alt="${product.name}" class="product-image w-full h-48 object-cover rounded-t-lg transition-transform duration-500">
                        <span class="absolute top-2 right-2 bg-white dark:bg-gray-800 text-primary px-2 py-1 rounded-full text-xs font-medium shadow-md">${product.category}</span>
                        <div class="hover-overlay">
                            <button onclick="viewProductDetails(${product.id})" class="bg-white/90 dark:bg-gray-800/90 text-primary py-2 px-6 rounded-full hover:bg-white dark:hover:bg-gray-800 transition-all duration-200 shadow-md">
                                View Details
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="flex items-start justify-between mb-2">
                            <h3 class="font-bold truncate flex-grow">${product.name}</h3>
                            <span class="font-bold ml-2">$${product.price.toFixed(2)}</span>
                        </div>
                        <p class="text-gray-600 dark:text-gray-400 text-sm mb-3">${product.brand}</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="star-rating mr-2">
                                    ${getStarRating(product.rating)}
                                </div>
                                <span class="text-xs text-gray-600 dark:text-gray-400">(${product.reviews_count})</span>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="event.stopPropagation(); addToWishlist(${product.id})" class="p-2 text-gray-500 hover:text-red-500 transition-colors duration-200" title="Add to Wishlist">
                                    <i class="far fa-heart"></i>
                                </button>
                                <button onclick="event.stopPropagation(); addToCart(${product.id})" class="p-2 text-gray-500 hover:text-primary transition-colors duration-200" title="Add to Cart">
                                    <i class="fas fa-shopping-cart"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function displayCollaborativeRecommendations(collaborativeRecommendations) {
            const container = document.getElementById('collaborativeRecommendations');
            
            if (collaborativeRecommendations.length === 0) {
                container.innerHTML = '<div class="col-span-full text-center py-12"><i class="fas fa-users text-4xl text-gray-400 mb-4"></i><p class="text-gray-600 dark:text-gray-400">No recommendations from similar users yet. Browse more products to improve recommendations.</p></div>';
                return;
            }
            
            container.innerHTML = collaborativeRecommendations.map(product => `
                <div class="card product-card cursor-pointer transition-all duration-300 transform hover:-translate-y-2" onclick="viewProductDetails(${product.id})">
                    <div class="relative overflow-hidden">
                        ${Math.random() > 0.5 ? '<span class="recommendation-tag"><i class="fas fa-users mr-1"></i> Popular Choice</span>' : ''}
                        <img src="${product.image}" alt="${product.name}" class="product-image w-full h-48 object-cover rounded-t-lg transition-transform duration-500">
                        <span class="absolute top-2 right-2 bg-white dark:bg-gray-800 text-primary px-2 py-1 rounded-full text-xs font-medium shadow-md">${product.category}</span>
                        <div class="hover-overlay">
                            <button onclick="viewProductDetails(${product.id})" class="bg-white/90 dark:bg-gray-800/90 text-primary py-2 px-6 rounded-full hover:bg-white dark:hover:bg-gray-800 transition-all duration-200 shadow-md">
                                View Details
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="flex items-start justify-between mb-2">
                            <h3 class="font-bold truncate flex-grow">${product.name}</h3>
                            <span class="font-bold ml-2">$${product.price.toFixed(2)}</span>
                        </div>
                        <p class="text-gray-600 dark:text-gray-400 text-sm mb-3">${product.brand}</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="star-rating mr-2">
                                    ${getStarRating(product.rating)}
                                </div>
                                <span class="text-xs text-gray-600 dark:text-gray-400">(${product.reviews_count})</span>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="event.stopPropagation(); addToWishlist(${product.id})" class="p-2 text-gray-500 hover:text-red-500 transition-colors duration-200" title="Add to Wishlist">
                                    <i class="far fa-heart"></i>
                                </button>
                                <button onclick="event.stopPropagation(); addToCart(${product.id})" class="p-2 text-gray-500 hover:text-primary transition-colors duration-200" title="Add to Cart">
                                    <i class="fas fa-shopping-cart"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function refreshRecommendations() {
            // Simulate refreshing recommendations
            loadRecommendations();
            showToast('Recommendations refreshed');
        }

        // User Profile Functions
        function initUserProfile() {
            if (!currentUser) {
                navigateTo('login');
                return;
            }
            
            // Update profile header
            document.getElementById('profileUserName').textContent = `${currentUser.first_name} ${currentUser.last_name}`;
            document.getElementById('profileUserEmail').textContent = currentUser.email;
            
            // Format date
            const memberDate = new Date(currentUser.created_at);
            const options = { year: 'numeric', month: 'long' };
            document.getElementById('profileMemberSince').textContent = `Member since ${memberDate.toLocaleDateString('en-US', options)}`;
            
            // Load user orders
            loadUserOrders();
            
            // Load wishlist
            loadWishlist();
            
            // Load profile settings
            loadProfileSettings();
            
            // Initialize profile charts
            initProfileCharts();
        }

        function showProfileTab(tab) {
            // Hide all tabs
            document.querySelectorAll('.profile-tab').forEach(t => t.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(`${tab}Tab`).classList.add('active');
            
            // Update active button
            document.querySelectorAll('[id$="TabBtn"]').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`${tab}TabBtn`).classList.add('active');
        }

        function loadUserOrders() {
            if (!currentUser) return;
            
            // Find user's orders
            const userOrders = mockOrders.filter(o => o.user_id === currentUser.id);
            
            // Update stats
            document.getElementById('statsOrdersCount').textContent = userOrders.length;
            
            // Calculate total spent
            const totalSpent = userOrders.reduce((total, order) => total + order.total, 0);
            document.getElementById('statsTotalSpent').textContent = `$${totalSpent.toFixed(2)}`;
            
            // Update recent orders table
            const recentOrdersTable = document.getElementById('recentOrdersTable');
            
            if (userOrders.length === 0) {
                recentOrdersTable.innerHTML = `
                    <tr>
                        <td colspan="6" class="text-center py-4 text-gray-600 dark:text-gray-400">No orders found</td>
                    </tr>
                `;
                return;
            }
            
            recentOrdersTable.innerHTML = userOrders.slice(0, 5).map(order => {
                const orderDate = new Date(order.date);
                const formattedDate = orderDate.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
                
                return `
                    <tr>
                        <td>#${order.id}</td>
                        <td>${formattedDate}</td>
                        <td>${order.items.length} item${order.items.length > 1 ? 's' : ''}</td>
                        <td>$${order.total.toFixed(2)}</td>
                        <td>
                            <span class="px-3 py-1 inline-block rounded-full text-xs status-${order.status}">
                                ${order.status.charAt(0).toUpperCase() + order.status.slice(1)}
                            </span>
                        </td>
                        <td>
                            <button class="text-primary hover:text-primary-dark p-1" onclick="viewOrderDetails(${order.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
            
            // Update orders container
            const ordersContainer = document.getElementById('ordersContainer');
            
            if (userOrders.length === 0) {
                ordersContainer.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-shopping-bag text-4xl text-gray-400 mb-4"></i>
                        <p class="text-gray-600 dark:text-gray-400">No orders found</p>
                        <button onclick="navigateTo('home')" class="mt-4 text-primary hover:text-primary-dark flex items-center mx-auto">
                            <i class="fas fa-shopping-cart mr-2"></i>
                            <span>Start Shopping</span>
                        </button>
                    </div>
                `;
                return;
            }
            
            ordersContainer.innerHTML = userOrders.map(order => {
                const orderDate = new Date(order.date);
                const formattedDate = orderDate.toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                // Get status class
                let statusClass = '';
                switch (order.status) {
                    case 'delivered':
                        statusClass = 'status-delivered';
                        break;
                    case 'shipped':
                        statusClass = 'status-shipped';
                        break;
                    case 'processing':
                        statusClass = 'status-processing';
                        break;
                    case 'pending':
                        statusClass = 'status-pending';
                        break;
                }
                
                // Get item details
                const itemsHtml = order.items.slice(0, 2).map(item => {
                    const product = mockProducts.find(p => p.id === item.product_id);
                    return `
                        <div class="flex items-center py-2">
                            <img src="${product.image}" alt="${product.name}" class="w-12 h-12 object-cover rounded mr-3">
                            <div class="flex-grow">
                                <p class="font-medium">${product.name}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Qty: ${item.quantity} × $${item.price.toFixed(2)}</p>
                            </div>
                        </div>
                    `;
                }).join('');
                
                // Add "more items" indicator if needed
                const moreItemsHtml = order.items.length > 2 ? 
                    `<p class="text-sm text-gray-600 dark:text-gray-400 mt-2">+ ${order.items.length - 2} more item${order.items.length - 2 > 1 ? 's' : ''}</p>` : '';
                
                return `
                    <div class="card order-card p-6 mb-4">
                        <div class="flex flex-col md:flex-row justify-between mb-4">
                            <div>
                                <div class="flex items-center">
                                    <h3 class="font-bold text-lg mr-3">Order #${order.id}</h3>
                                    <span class="order-status ${statusClass}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</span>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-400">${formattedDate}</p>
                            </div>
                            <div class="mt-4 md:mt-0 text-right">
                                <p class="font-bold text-lg">$${order.total.toFixed(2)}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">${order.items.length} item${order.items.length > 1 ? 's' : ''}</p>
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
                            ${itemsHtml}
                            ${moreItemsHtml}
                        </div>
                        
                        <div class="flex justify-between mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                            <button onclick="viewOrderDetails(${order.id})" class="text-primary hover:text-primary-dark">
                                View Order Details
                            </button>
                            ${order.status === 'delivered' ? 
                                `<button class="bg-primary bg-opacity-10 text-primary px-3 py-1 rounded-md hover:bg-opacity-20 transition-colors duration-200">
                                    <i class="fas fa-redo-alt mr-1"></i> Buy Again
                                </button>` : ''
                            }
                        </div>
                    </div>
                `;
            }).join('');
        }

        function viewOrderDetails(orderId) {
            // Find the order
            const order = mockOrders.find(o => o.id === orderId);
            
            if (!order) {
                showToast('Order not found');
                return;
            }
            
            const orderDate = new Date(order.date);
            const formattedDate = orderDate.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Create status class
            let statusClass = '';
            switch (order.status) {
                case 'delivered':
                    statusClass = 'status-delivered';
                    break;
                case 'shipped':
                    statusClass = 'status-shipped';
                    break;
                case 'processing':
                    statusClass = 'status-processing';
                    break;
                case 'pending':
                    statusClass = 'status-pending';
                    break;
            }
            
            // Create modal content
            const modal = document.getElementById('productDetailsModal');
            const content = document.getElementById('productDetailsContent');
            
            content.innerHTML = `
                <h2 class="text-2xl font-bold mb-6">Order #${order.id}</h2>
                
                <div class="flex flex-col md:flex-row justify-between mb-6">
                    <div>
                        <p class="text-gray-600 dark:text-gray-400">Ordered on</p>
                        <p class="font-medium">${formattedDate}</p>
                    </div>
                    <div class="mt-2 md:mt-0">
                        <p class="text-gray-600 dark:text-gray-400">Status</p>
                        <p><span class="order-status ${statusClass}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</span></p>
                    </div>
                    <div class="mt-2 md:mt-0">
                        <p class="text-gray-600 dark:text-gray-400">Total</p>
                        <p class="font-bold">$${order.total.toFixed(2)}</p>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div class="card p-6">
                        <h3 class="font-semibold mb-4">Shipping Address</h3>
                        <p>${order.shipping?.name || 'N/A'}</p>
                        <p>${order.shipping?.address || ''}</p>
                        <p>${order.shipping?.city || ''} ${order.shipping?.zip || ''}</p>
                        <p>Phone: ${order.shipping?.phone || 'N/A'}</p>
                    </div>
                    <div class="card p-6">
                        <h3 class="font-semibold mb-4">Payment Information</h3>
                        <p>Payment Method: Credit Card</p>
                        <p>Card: **** **** **** 1234</p>
                        <p>Billing Address: Same as shipping</p>
                    </div>
                </div>
                
                <div class="card p-6 mb-8">
                    <h3 class="font-semibold mb-4">Order Items</h3>
                    <div class="divide-y divide-gray-200 dark:divide-gray-700">
                        ${order.items.map(item => {
                            const product = mockProducts.find(p => p.id === item.product_id);
                            return `
                                <div class="flex py-4">
                                    <img src="${product.image}" alt="${product.name}" class="w-16 h-16 object-cover rounded mr-4">
                                    <div class="flex-grow">
                                        <h4 class="font-medium">${product.name}</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Qty: ${item.quantity}</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="font-bold">$${(item.price * item.quantity).toFixed(2)}</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">$${item.price.toFixed(2)} each</p>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    
                    <div class="border-t border-gray-200 dark:border-gray-700 pt-4 mt-4">
                        <div class="flex justify-between mb-2">
                            <span class="text-gray-600 dark:text-gray-400">Subtotal:</span>
                            <span>$${(order.total - (order.total * 0.08) - (order.total >= 50 ? 0 : 5.99)).toFixed(2)}</span>
                        </div>
                        <div class="flex justify-between mb-2">
                            <span class="text-gray-600 dark:text-gray-400">Shipping:</span>
                            <span>${order.total >= 50 ? 'FREE' : '$5.99'}</span>
                        </div>
                        <div class="flex justify-between mb-2">
                            <span class="text-gray-600 dark:text-gray-400">Tax:</span>
                            <span>$${(order.total * 0.08).toFixed(2)}</span>
                        </div>
                        <div class="flex justify-between font-bold text-lg mt-4">
                            <span>Total:</span>
                            <span>$${order.total.toFixed(2)}</span>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4">
                    <button onclick="closeProductDetailsModal()" class="py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200">
                        Close
                    </button>
                    ${order.status === 'delivered' ? 
                        `<button class="btn-primary py-2 px-6 rounded-md">
                            <i class="fas fa-redo-alt mr-2"></i> Buy Again
                        </button>` : ''
                    }
                </div>
            `;
            
            modal.style.display = 'block';
        }

        function loadWishlist() {
            if (!currentUser) return;
            
            // Find user's wishlist
            const userWishlist = mockWishlist.find(w => w.user_id === currentUser.id);
            
            // Update stats
            document.getElementById('statsWishlistCount').textContent = userWishlist ? userWishlist.products.length : 0;
            
            // Load wishlist items
            const wishlistContainer = document.getElementById('wishlistContainer');
            
            if (!userWishlist || userWishlist.products.length === 0) {
                wishlistContainer.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <i class="far fa-heart text-4xl text-gray-400 mb-4"></i>
                        <p class="text-gray-600 dark:text-gray-400">Your wishlist is empty</p>
                        <button onclick="navigateTo('home')" class="mt-4 text-primary hover:text-primary-dark flex items-center mx-auto">
                            <i class="fas fa-shopping-cart mr-2"></i>
                            <span>Explore Products</span>
                        </button>
                    </div>
                `;
                return;
            }
            
            // Get wishlist products
            const wishlistProducts = userWishlist.products.map(id => mockProducts.find(p => p.id === id)).filter(Boolean);
            
            wishlistContainer.innerHTML = wishlistProducts.map(product => `
                <div class="card product-card cursor-pointer transition-all duration-300 transform hover:-translate-y-2">
                    <div class="relative overflow-hidden">
                        <img src="${product.image}" alt="${product.name}" class="product-image w-full h-48 object-cover rounded-t-lg transition-transform duration-500">
                        <span class="absolute top-2 right-2 bg-white dark:bg-gray-800 text-primary px-2 py-1 rounded-full text-xs font-medium shadow-md">${product.category}</span>
                        <div class="hover-overlay">
                            <button onclick="viewProductDetails(${product.id})" class="bg-white/90 dark:bg-gray-800/90 text-primary py-2 px-6 rounded-full hover:bg-white dark:hover:bg-gray-800 transition-all duration-200 shadow-md">
                                View Details
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="flex items-start justify-between mb-2">
                            <h3 class="font-bold truncate flex-grow">${product.name}</h3>
                            <span class="font-bold ml-2">$${product.price.toFixed(2)}</span>
                        </div>
                        <p class="text-gray-600 dark:text-gray-400 text-sm mb-3">${product.brand}</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="star-rating mr-2">
                                    ${getStarRating(product.rating)}
                                </div>
                                <span class="text-xs text-gray-600 dark:text-gray-400">(${product.reviews_count})</span>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="removeFromWishlist(${product.id})" class="p-2 text-red-500 hover:text-red-700 transition-colors duration-200" title="Remove from Wishlist">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                                <button onclick="addToCart(${product.id})" class="btn-primary py-1 px-3 rounded-full text-sm">
                                    Add to Cart
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function removeFromWishlist(productId) {
            if (!currentUser) return;
            
            // Find user's wishlist
            const userWishlist = mockWishlist.find(w => w.user_id === currentUser.id);
            
            if (!userWishlist) return;
            
            // Remove product from wishlist
            const productIndex = userWishlist.products.indexOf(productId);
            
            if (productIndex !== -1) {
                userWishlist.products.splice(productIndex, 1);
                
                // Update UI
                loadWishlist();
                
                // Show toast
                const product = mockProducts.find(p => p.id === productId);
                showToast(`Removed ${product.name} from your wishlist`);
            }
        }

        function sortWishlist() {
            if (!currentUser) return;
            
            // Find user's wishlist
            const userWishlist = mockWishlist.find(w => w.user_id === currentUser.id);
            
            if (!userWishlist || userWishlist.products.length === 0) return;
            
            const sortOption = document.getElementById('wishlistSort').value;
            
            // Get wishlist products
            let wishlistProducts = userWishlist.products.map(id => mockProducts.find(p => p.id === id)).filter(Boolean);
            
            // Sort products
            switch (sortOption) {
                case 'price_low':
                    wishlistProducts.sort((a, b) => a.price - b.price);
                    break;
                case 'price_high':
                    wishlistProducts.sort((a, b) => b.price - a.price);
                    break;
                case 'name':
                    wishlistProducts.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                default: // date (use the order in the wishlist array)
                    // No need to sort
                    break;
            }
            
            // Update UI
            const wishlistContainer = document.getElementById('wishlistContainer');
            
            wishlistContainer.innerHTML = wishlistProducts.map(product => `
                <div class="card product-card cursor-pointer transition-all duration-300 transform hover:-translate-y-2">
                    <div class="relative overflow-hidden">
                        <img src="${product.image}" alt="${product.name}" class="product-image w-full h-48 object-cover rounded-t-lg transition-transform duration-500">
                        <span class="absolute top-2 right-2 bg-white dark:bg-gray-800 text-primary px-2 py-1 rounded-full text-xs font-medium shadow-md">${product.category}</span>
                        <div class="hover-overlay">
                            <button onclick="viewProductDetails(${product.id})" class="bg-white/90 dark:bg-gray-800/90 text-primary py-2 px-6 rounded-full hover:bg-white dark:hover:bg-gray-800 transition-all duration-200 shadow-md">
                                View Details
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="flex items-start justify-between mb-2">
                            <h3 class="font-bold truncate flex-grow">${product.name}</h3>
                            <span class="font-bold ml-2">$${product.price.toFixed(2)}</span>
                        </div>
                        <p class="text-gray-600 dark:text-gray-400 text-sm mb-3">${product.brand}</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="star-rating mr-2">
                                    ${getStarRating(product.rating)}
                                </div>
                                <span class="text-xs text-gray-600 dark:text-gray-400">(${product.reviews_count})</span>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="removeFromWishlist(${product.id})" class="p-2 text-red-500 hover:text-red-700 transition-colors duration-200" title="Remove from Wishlist">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                                <button onclick="addToCart(${product.id})" class="btn-primary py-1 px-3 rounded-full text-sm">
                                    Add to Cart
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function loadProfileSettings() {
            if (!currentUser) return;
            
            // Set form values
            document.getElementById('settingsFirstName').value = currentUser.first_name;
            document.getElementById('settingsLastName').value = currentUser.last_name;
            document.getElementById('settingsEmail').value = currentUser.email;
            document.getElementById('settingsPhone').value = currentUser.phone || '';
        }

        function updateAccountSettings(event) {
            event.preventDefault();
            
            if (!currentUser) return false;
            
            // Get form values
            const firstName = document.getElementById('settingsFirstName').value;
            const lastName = document.getElementById('settingsLastName').value;
            const email = document.getElementById('settingsEmail').value;
            const phone = document.getElementById('settingsPhone').value;
            
            // Validate form
            if (!firstName || !lastName || !email) {
                showToast('Please fill in all required fields');
                return false;
            }
            
            // Update user info
            currentUser.first_name = firstName;
            currentUser.last_name = lastName;
            currentUser.email = email;
            currentUser.phone = phone;
            
            // Update mockUsers array
            const userIndex = mockUsers.findIndex(u => u.id === currentUser.id);
            
            if (userIndex !== -1) {
                mockUsers[userIndex].first_name = firstName;
                mockUsers[userIndex].last_name = lastName;
                mockUsers[userIndex].email = email;
                mockUsers[userIndex].phone = phone;
            }
            
            // Update localStorage
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            // Update UI
            updateUserUI();
            initUserProfile();
            
            // Show toast
            showToast('Account settings updated successfully');
            
            return false;
        }

        function updatePassword(event) {
            event.preventDefault();
            
            if (!currentUser) return false;
            
            // Get form values
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmNewPassword = document.getElementById('confirmNewPassword').value;
            
            // Validate form
            if (!currentPassword || !newPassword || !confirmNewPassword) {
                showToast('Please fill in all password fields');
                return false;
            }
            
            // Check if current password is correct
            const user = mockUsers.find(u => u.id === currentUser.id);
            
            if (!user || user.password !== currentPassword) {
                showToast('Current password is incorrect');
                return false;
            }
            
            // Check if new passwords match
            if (newPassword !== confirmNewPassword) {
                showToast('New passwords do not match');
                return false;
            }
            
            // Update password in mockUsers array
            user.password = newPassword;
            
            // Clear form
            document.getElementById('passwordChangeForm').reset();
            
            // Show toast
            showToast('Password updated successfully');
            
            return false;
        }

        function saveNotificationPreferences() {
            if (!currentUser) return;
            
            // Get preferences
            const orderNotifications = document.getElementById('orderNotifications').checked;
            const priceAlerts = document.getElementById('priceAlerts').checked;
            const recommendationAlerts = document.getElementById('recommendationAlerts').checked;
            const marketingEmails = document.getElementById('marketingEmails').checked;
            
            // In a real app, this would update user preferences in the database
            console.log('Notification preferences saved:', {
                orderNotifications,
                priceAlerts,
                recommendationAlerts,
                marketingEmails
            });
            
            // Show toast
            showToast('Notification preferences saved');
        }

        function editProfileInfo() {
            // Navigate to settings tab
            showProfileTab('settings');
        }

        function initProfileCharts() {
            // Initialize recommendation quality chart
            const recommendationQualityCtx = document.getElementById('recommendationQualityChart').getContext('2d');
            
            new Chart(recommendationQualityCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Relevance Score',
                        data: [65, 72, 78, 75, 82, 88],
                        backgroundColor: '#5D5CDE',
                        borderColor: '#5D5CDE',
                        borderWidth: 2,
                        tension: 0.3,
                        pointBackgroundColor: '#5D5CDE',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 50,
                            max: 100,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                color: '#666'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#666'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.7)',
                            padding: 10,
                            bodyFont: {
                                size: 14
                            },
                            titleFont: {
                                size: 14
                            }
                        }
                    }
                }
            });
        }

        // Admin Dashboard Functions
        function initAdminDashboard() {
            if (!currentUser || currentUser.role !== 'admin') {
                navigateTo('login');
                return;
            }
            
            // Show dashboard tab by default
            showAdminTab('dashboard');
            
            // Init admin charts
            initAdminCharts();
            
            // Load products table
            loadAdminProducts();
            
            // Load users table
            loadAdminUsers();
        }

        function showAdminTab(tab) {
            // Hide all tabs
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.add('hidden'));
            
            // Show selected tab
            document.getElementById(`${tab}Tab`).classList.remove('hidden');
            
            // Update active button
            document.querySelectorAll('[id$="Btn"]').forEach(btn => {
                btn.classList.remove('bg-primary');
                btn.classList.remove('text-white');
            });
            
            document.getElementById(`${tab}Btn`).classList.add('bg-primary');
            document.getElementById(`${tab}Btn`).classList.add('text-white');
        }

        function initAdminCharts() {
            // Sales Chart
            const salesChartCtx = document.getElementById('salesChart').getContext('2d');
            
            new Chart(salesChartCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Sales',
                        data: [1200, 1900, 3000, 5000, 6000, 4000],
                        backgroundColor: 'rgba(93, 92, 222, 0.1)',
                        borderColor: '#5D5CDE',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
            
            // Recommendations Chart
            const recommendationsChartCtx = document.getElementById('recommendationsChart').getContext('2d');
            
            new Chart(recommendationsChartCtx, {
                type: 'bar',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [
                        {
                            label: 'Recommendation Views',
                            data: [500, 650, 800, 950, 1100, 1300],
                            backgroundColor: 'rgba(93, 92, 222, 0.7)'
                        },
                        {
                            label: 'Recommendations Purchased',
                            data: [150, 220, 300, 400, 550, 700],
                            backgroundColor: '#22c55e'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
            
            // New Users Chart
            const newUsersChartCtx = document.getElementById('newUsersChart').getContext('2d');
            
            new Chart(newUsersChartCtx, {
                type: 'bar',
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                    datasets: [{
                        label: 'New Users',
                        data: [65, 78, 52, 98],
                        backgroundColor: '#5D5CDE',
                        borderRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
            
            // User Segments Chart
            const userSegmentsChartCtx = document.getElementById('userSegmentsChart').getContext('2d');
            
            new Chart(userSegmentsChartCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Regular Customers', 'New Users', 'Bargain Hunters', 'Premium Shoppers', 'Occasional Buyers'],
                    datasets: [{
                        data: [35, 25, 15, 15, 10],
                        backgroundColor: ['#5D5CDE', '#22c55e', '#f59e0b', '#ef4444', '#3b82f6']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    },
                    cutout: '70%'
                }
            });
            
            // Conversion Chart
            const conversionChartCtx = document.getElementById('conversionChart').getContext('2d');
            
            new Chart(conversionChartCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Conversion Rate (%)',
                        data: [4.2, 4.8, 5.3, 5.7, 6.2, 7.1],
                        backgroundColor: 'rgba(93, 92, 222, 0.1)',
                        borderColor: '#5D5CDE',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        function loadAdminProducts() {
            const productsTableAdmin = document.getElementById('productsTableAdmin');
            
            productsTableAdmin.innerHTML = mockProducts.map(product => `
                <tr>
                    <td>${product.id}</td>
                    <td>
                        <img src="${product.image}" alt="${product.name}" class="w-12 h-12 object-cover rounded">
                    </td>
                    <td class="font-medium">${product.name}</td>
                    <td>${product.category.charAt(0).toUpperCase() + product.category.slice(1)}</td>
                    <td>$${product.price.toFixed(2)}</td>
                    <td>
                        <span class="${product.stock < 10 ? 'text-red-500' : product.stock < 20 ? 'text-yellow-500' : 'text-green-500'}">
                            ${product.stock}
                        </span>
                    </td>
                    <td>
                        <div class="flex space-x-2">
                            <button onclick="editProduct(${product.id})" class="p-2 text-blue-500 hover:text-blue-700 transition-colors duration-200">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteProduct(${product.id})" class="p-2 text-red-500 hover:text-red-700 transition-colors duration-200">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
            
            // Update product count
            document.getElementById('productsShowing').textContent = mockProducts.length;
            document.getElementById('productsTotal').textContent = mockProducts.length;
        }

        function loadAdminUsers() {
            const usersTableAdmin = document.getElementById('usersTableAdmin');
            
            usersTableAdmin.innerHTML = mockUsers.map(user => {
                const lastActive = new Date(user.last_active);
                const formattedLastActive = lastActive.toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric'
                });
                
                return `
                    <tr>
                        <td>${user.id}</td>
                        <td class="font-medium">${user.first_name} ${user.last_name}</td>
                        <td>${user.email}</td>
                        <td>
                            <span class="px-2 py-1 rounded-full text-xs ${user.role === 'admin' ? 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200' : 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200'}">
                                ${user.role.charAt(0).toUpperCase() + user.role.slice(1)}
                            </span>
                        </td>
                        <td>${formattedLastActive}</td>
                        <td>
                            <div class="flex space-x-2">
                                <button onclick="editUser(${user.id})" class="p-2 text-blue-500 hover:text-blue-700 transition-colors duration-200">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="deleteUser(${user.id})" class="p-2 text-red-500 hover:text-red-700 transition-colors duration-200">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
            
            // Update user count
            document.getElementById('usersShowing').textContent = mockUsers.length;
            document.getElementById('usersTotal').textContent = mockUsers.length;
        }

        function openAddProductModal() {
            // Clear form
            document.getElementById('addProductForm').reset();
            document.getElementById('productId').value = '';
            
            // Update title
            document.querySelector('#addProductModal h2').textContent = 'Add New Product';
            
            // Show modal
            document.getElementById('addProductModal').style.display = 'block';
        }

        function closeAddProductModal() {
            document.getElementById('addProductModal').style.display = 'none';
        }

        function handleAddProduct(event) {
            event.preventDefault();
            
            // Get form values
            const productId = document.getElementById('productId').value;
            const name = document.getElementById('productName').value;
            const brand = document.getElementById('productBrand').value;
            const category = document.getElementById('productCategory').value;
            const description = document.getElementById('productDescription').value;
            const price = parseFloat(document.getElementById('productPrice').value);
            const stock = parseInt(document.getElementById('productStock').value);
            
            // Validate form
            if (!name || !brand || !category || !description || isNaN(price) || isNaN(stock)) {
                showToast('Please fill in all fields');
                return false;
            }
            
            if (productId) {
                // Edit existing product
                const productIndex = mockProducts.findIndex(p => p.id === parseInt(productId));
                
                if (productIndex !== -1) {
                    mockProducts[productIndex].name = name;
                    mockProducts[productIndex].brand = brand;
                    mockProducts[productIndex].category = category;
                    mockProducts[productIndex].description = description;
                    mockProducts[productIndex].price = price;
                    mockProducts[productIndex].stock = stock;
                    
                    showToast('Product updated successfully');
                }
            } else {
                // Add new product
                const newId = Math.max(...mockProducts.map(p => p.id)) + 1;
                
                mockProducts.push({
                    id: newId,
                    name,
                    brand,
                    category,
                    description,
                    price,
                    stock,
                    rating: 4.0, // Default rating
                    reviews_count: 0, // Default reviews count
                    image: `https://picsum.photos/id/${Math.floor(Math.random() * 30) + 100}/500/300`
                });
                
                showToast('Product added successfully');
            }
            
            // Close modal
            closeAddProductModal();
            
            // Reload products table
            loadAdminProducts();
            
            return false;
        }

        function editProduct(productId) {
            // Find product
            const product = mockProducts.find(p => p.id === productId);
            
            if (!product) return;
            
            // Fill form
            document.getElementById('productId').value = product.id;
            document.getElementById('productName').value = product.name;
            document.getElementById('productBrand').value = product.brand;
            document.getElementById('productCategory').value = product.category;
            document.getElementById('productDescription').value = product.description;
            document.getElementById('productPrice').value = product.price;
            document.getElementById('productStock').value = product.stock;
            
            // Update title
            document.querySelector('#addProductModal h2').textContent = 'Edit Product';
            
            // Show modal
            document.getElementById('addProductModal').style.display = 'block';
        }

        function deleteProduct(productId) {
            // Confirm delete
            if (!confirm('Are you sure you want to delete this product?')) return;
            
            // Find product index
            const productIndex = mockProducts.findIndex(p => p.id === productId);
            
            if (productIndex !== -1) {
                // Remove product
                mockProducts.splice(productIndex, 1);
                
                // Reload products table
                loadAdminProducts();
                
                // Show toast
                showToast('Product deleted successfully');
            }
        }

        function searchAdminProducts() {
            const query = document.getElementById('productSearchAdmin').value.toLowerCase();
            
            if (!query) {
                loadAdminProducts();
                return;
            }
            
            // Filter products
            const filteredProducts = mockProducts.filter(p => 
                p.name.toLowerCase().includes(query) || 
                p.brand.toLowerCase().includes(query) || 
                p.category.toLowerCase().includes(query) || 
                p.description.toLowerCase().includes(query)
            );
            
            // Update table
            const productsTableAdmin = document.getElementById('productsTableAdmin');
            
            productsTableAdmin.innerHTML = filteredProducts.map(product => `
                <tr>
                    <td>${product.id}</td>
                    <td>
                        <img src="${product.image}" alt="${product.name}" class="w-12 h-12 object-cover rounded">
                    </td>
                    <td class="font-medium">${product.name}</td>
                    <td>${product.category.charAt(0).toUpperCase() + product.category.slice(1)}</td>
                    <td>$${product.price.toFixed(2)}</td>
                    <td>
                        <span class="${product.stock < 10 ? 'text-red-500' : product.stock < 20 ? 'text-yellow-500' : 'text-green-500'}">
                            ${product.stock}
                        </span>
                    </td>
                    <td>
                        <div class="flex space-x-2">
                            <button onclick="editProduct(${product.id})" class="p-2 text-blue-500 hover:text-blue-700 transition-colors duration-200">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteProduct(${product.id})" class="p-2 text-red-500 hover:text-red-700 transition-colors duration-200">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
            
            // Update product count
            document.getElementById('productsShowing').textContent = filteredProducts.length;
            document.getElementById('productsTotal').textContent = mockProducts.length;
        }

        function filterAdminProducts() {
            const category = document.getElementById('categoryFilterAdmin').value.toLowerCase();
            
            if (!category) {
                loadAdminProducts();
                return;
            }
            
            // Filter products
            const filteredProducts = mockProducts.filter(p => p.category.toLowerCase() === category);
            
            // Update table
            const productsTableAdmin = document.getElementById('productsTableAdmin');
            
            productsTableAdmin.innerHTML = filteredProducts.map(product => `
                <tr>
                    <td>${product.id}</td>
                    <td>
                        <img src="${product.image}" alt="${product.name}" class="w-12 h-12 object-cover rounded">
                    </td>
                    <td class="font-medium">${product.name}</td>
                    <td>${product.category.charAt(0).toUpperCase() + product.category.slice(1)}</td>
                    <td>$${product.price.toFixed(2)}</td>
                    <td>
                        <span class="${product.stock < 10 ? 'text-red-500' : product.stock < 20 ? 'text-yellow-500' : 'text-green-500'}">
                            ${product.stock}
                        </span>
                    </td>
                    <td>
                        <div class="flex space-x-2">
                            <button onclick="editProduct(${product.id})" class="p-2 text-blue-500 hover:text-blue-700 transition-colors duration-200">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteProduct(${product.id})" class="p-2 text-red-500 hover:text-red-700 transition-colors duration-200">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
            
            // Update product count
            document.getElementById('productsShowing').textContent = filteredProducts.length;
            document.getElementById('productsTotal').textContent = mockProducts.length;
        }

        function openAddUserModal() {
            // Clear form
            document.getElementById('addUserForm').reset();
            document.getElementById('userId').value = '';
            
            // Update title
            document.querySelector('#addUserModal h2').textContent = 'Add New User';
            
            // Show modal
            document.getElementById('addUserModal').style.display = 'block';
        }

        function closeAddUserModal() {
            document.getElementById('addUserModal').style.display = 'none';
        }

        function handleAddUser(event) {
            event.preventDefault();
            
            // Get form values
            const userId = document.getElementById('userId').value;
            const firstName = document.getElementById('userFirstName').value;
            const lastName = document.getElementById('userLastName').value;
            const email = document.getElementById('userEmail').value;
            const password = document.getElementById('userPassword').value;
            const role = document.getElementById('userRole').value;
            
            // Validate form
            if (!firstName || !lastName || !email || !role) {
                showToast('Please fill in all required fields');
                return false;
            }
            
            if (userId) {
                // Edit existing user
                const userIndex = mockUsers.findIndex(u => u.id === parseInt(userId));
                
                if (userIndex !== -1) {
                    mockUsers[userIndex].first_name = firstName;
                    mockUsers[userIndex].last_name = lastName;
                    mockUsers[userIndex].email = email;
                    mockUsers[userIndex].role = role;
                    
                    if (password) {
                        mockUsers[userIndex].password = password;
                    }
                    
                    // Update currentUser if editing current user
                    if (currentUser && currentUser.id === parseInt(userId)) {
                        currentUser.first_name = firstName;
                        currentUser.last_name = lastName;
                        currentUser.email = email;
                        currentUser.role = role;
                        
                        // Update localStorage
                        localStorage.setItem('currentUser', JSON.stringify(currentUser));
                        
                        // Update UI
                        updateUserUI();
                    }
                    
                    showToast('User updated successfully');
                }
            } else {
                // Add new user
                const newId = Math.max(...mockUsers.map(u => u.id)) + 1;
                
                if (!password) {
                    showToast('Password is required for new users');
                    return false;
                }
                
                mockUsers.push({
                    id: newId,
                    first_name: firstName,
                    last_name: lastName,
                    email: email,
                    password: password,
                    role: role,
                    last_active: new Date().toISOString(),
                    created_at: new Date().toISOString()
                });
                
                showToast('User added successfully');
            }
            
            // Close modal
            closeAddUserModal();
            
            // Reload users table
            loadAdminUsers();
            
            return false;
        }

        function editUser(userId) {
            // Find user
            const user = mockUsers.find(u => u.id === userId);
            
            if (!user) return;
            
            // Fill form
            document.getElementById('userId').value = user.id;
            document.getElementById('userFirstName').value = user.first_name;
            document.getElementById('userLastName').value = user.last_name;
            document.getElementById('userEmail').value = user.email;
            document.getElementById('userPassword').value = '';
            document.getElementById('userRole').value = user.role;
            
            // Update title
            document.querySelector('#addUserModal h2').textContent = 'Edit User';
            
            // Show modal
            document.getElementById('addUserModal').style.display = 'block';
        }

        function deleteUser(userId) {
            // Prevent deleting current user
            if (currentUser && currentUser.id === userId) {
                showToast('You cannot delete your own account');
                return;
            }
            
            // Confirm delete
            if (!confirm('Are you sure you want to delete this user?')) return;
            
            // Find user index
            const userIndex = mockUsers.findIndex(u => u.id === userId);
            
            if (userIndex !== -1) {
                // Remove user
                mockUsers.splice(userIndex, 1);
                
                // Reload users table
                loadAdminUsers();
                
                // Show toast
                showToast('User deleted successfully');
            }
        }

        function searchAdminUsers() {
            const query = document.getElementById('userSearchAdmin').value.toLowerCase();
            
            if (!query) {
                loadAdminUsers();
                return;
            }
            
            // Filter users
            const filteredUsers = mockUsers.filter(u => 
                u.first_name.toLowerCase().includes(query) || 
                u.last_name.toLowerCase().includes(query) || 
                u.email.toLowerCase().includes(query) || 
                u.role.toLowerCase().includes(query)
            );
            
            // Update table
            const usersTableAdmin = document.getElementById('usersTableAdmin');
            
            usersTableAdmin.innerHTML = filteredUsers.map(user => {
                const lastActive = new Date(user.last_active);
                const formattedLastActive = lastActive.toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric'
                });
                
                return `
                    <tr>
                        <td>${user.id}</td>
                        <td class="font-medium">${user.first_name} ${user.last_name}</td>
                        <td>${user.email}</td>
                        <td>
                            <span class="px-2 py-1 rounded-full text-xs ${user.role === 'admin' ? 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200' : 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200'}">
                                ${user.role.charAt(0).toUpperCase() + user.role.slice(1)}
                            </span>
                        </td>
                        <td>${formattedLastActive}</td>
                        <td>
                            <div class="flex space-x-2">
                                <button onclick="editUser(${user.id})" class="p-2 text-blue-500 hover:text-blue-700 transition-colors duration-200">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="deleteUser(${user.id})" class="p-2 text-red-500 hover:text-red-700 transition-colors duration-200">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
            
            // Update user count
            document.getElementById('usersShowing').textContent = filteredUsers.length;
            document.getElementById('usersTotal').textContent = mockUsers.length;
        }

        function filterAdminUsers() {
            const role = document.getElementById('roleFilterAdmin').value.toLowerCase();
            
            if (!role) {
                loadAdminUsers();
                return;
            }
            
            // Filter users
            const filteredUsers = mockUsers.filter(u => u.role.toLowerCase() === role);
            
            // Update table
            const usersTableAdmin = document.getElementById('usersTableAdmin');
            
            usersTableAdmin.innerHTML = filteredUsers.map(user => {
                const lastActive = new Date(user.last_active);
                const formattedLastActive = lastActive.toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric'
                });
                
                return `
                    <tr>
                        <td>${user.id}</td>
                        <td class="font-medium">${user.first_name} ${user.last_name}</td>
                        <td>${user.email}</td>
                        <td>
                            <span class="px-2 py-1 rounded-full text-xs ${user.role === 'admin' ? 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200' : 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200'}">
                                ${user.role.charAt(0).toUpperCase() + user.role.slice(1)}
                            </span>
                        </td>
                        <td>${formattedLastActive}</td>
                        <td>
                            <div class="flex space-x-2">
                                <button onclick="editUser(${user.id})" class="p-2 text-blue-500 hover:text-blue-700 transition-colors duration-200">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="deleteUser(${user.id})" class="p-2 text-red-500 hover:text-red-700 transition-colors duration-200">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
            
            // Update user count
            document.getElementById('usersShowing').textContent = filteredUsers.length;
            document.getElementById('usersTotal').textContent = mockUsers.length;
        }

        // Shopping Assistant Functions
        function openShoppingAssistant() {
            document.getElementById('shoppingAssistantModal').style.display = 'block';
            
            // Focus input
            document.getElementById('assistantInput').focus();
            
            // Add event listener for enter key
            document.getElementById('assistantInput').addEventListener('keyup', function(event) {
                if (event.key === 'Enter') {
                    sendToAssistant();
                }
            });
            
            // Add event listener for send button
            document.getElementById('sendToAssistant').addEventListener('click', sendToAssistant);
        }

        function closeShoppingAssistantModal() {
            document.getElementById('shoppingAssistantModal').style.display = 'none';
        }

        async function sendToAssistant() {
            const input = document.getElementById('assistantInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Clear input
            input.value = '';
            
            // Add user message to the chat
            const messagesContainer = document.getElementById('assistantMessages');
            messagesContainer.innerHTML += `
                <div class="flex items-start justify-end mb-4">
                    <div class="bg-primary text-white rounded-lg py-2 px-4 shadow-sm max-w-xs ml-auto">
                        <p>${message}</p>
                    </div>
                </div>
            `;
            
            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // Add loading indicator
            messagesContainer.innerHTML += `
                <div id="assistantLoading" class="flex items-start mb-4">
                    <div class="min-w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center mr-2">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="bg-white dark:bg-gray-700 rounded-lg py-2 px-4 shadow-sm max-w-xs">
                        <div class="flex items-center space-x-2">
                            <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0s;"></div>
                            <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.2s;"></div>
                            <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.4s;"></div>
                        </div>
                    </div>
                </div>
            `;
            
            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            try {
                // Call Poe API to get recommendations from Claude-3-Sonnet
                if (window.Poe) {
                    // Register a handler for the response
                    const handlerId = `assistant-handler-${Date.now()}`;
                    
                    window.Poe.registerHandler(handlerId, (result) => {
                        const msgResponse = result.responses[0];
                        
                        if (msgResponse.status === "error") {
                            // Remove loading indicator
                            document.getElementById('assistantLoading').remove();
                            
                            // Add error message
                            messagesContainer.innerHTML += `
                                <div class="flex items-start mb-4">
                                    <div class="min-w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center mr-2">
                                        <i class="fas fa-robot"></i>
                                    </div>
                                    <div class="bg-white dark:bg-gray-700 rounded-lg py-2 px-4 shadow-sm max-w-xs text-red-500">
                                        <p>Sorry, there was an error getting recommendations.</p>
                                    </div>
                                </div>
                            `;
                        } else if (msgResponse.status === "incomplete") {
                            // Update loading indicator with partial response
                            document.getElementById('assistantLoading').innerHTML = `
                                <div class="min-w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center mr-2">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div class="bg-white dark:bg-gray-700 rounded-lg py-2 px-4 shadow-sm max-w-xs">
                                    <p>${msgResponse.content}</p>
                                </div>
                            `;
                        } else if (msgResponse.status === "complete") {
                            // Remove loading indicator
                            document.getElementById('assistantLoading').remove();
                            
                            // Add complete response
                            messagesContainer.innerHTML += `
                                <div class="flex items-start mb-4">
                                    <div class="min-w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center mr-2">
                                        <i class="fas fa-robot"></i>
                                    </div>
                                    <div class="bg-white dark:bg-gray-700 rounded-lg py-2 px-4 shadow-sm max-w-xs">
                                        <p>${msgResponse.content}</p>
                                    </div>
                                </div>
                            `;
                        }
                        
                        // Scroll to bottom
                        messagesContainer.scrollTop = messagesContainer.scrollHeight;
                    });
                    
                    // Send message to Claude with shopping context
                    await window.Poe.sendUserMessage(
                        "@Claude-3.7-Sonnet You are a helpful shopping assistant for an e-commerce site called ShopSmart. Help the user find products, give recommendations, and answer shopping-related questions. Current categories: electronics, clothing, home, books, beauty, sports. Here's what the user says: " + message,
                        {
                            handler: handlerId,
                            stream: true,
                            openChat: false
                        }
                    );
                } else {
                    // If Poe API is not available, simulate a response
                    setTimeout(() => {
                        // Remove loading indicator
                        document.getElementById('assistantLoading').remove();
                        
                        // Add bot response
                        let response = "I'm sorry, but I can't access the recommendation system right now. Please try again later.";
                        
                        if (message.toLowerCase().includes("electronics")) {
                            response = "Based on your interest in electronics, I'd recommend checking out our Smart 4K TVs, Wireless Headphones, and Fitness Trackers. These are currently our top-rated products.";
                        } else if (message.toLowerCase().includes("clothing")) {
                            response = "We have a great selection of clothing! Our most popular items are the Organic Cotton T-Shirts, Leather Crossbody Bags, and Men's Slim Fit Jeans.";
                        } else if (message.toLowerCase().includes("gift")) {
                            response = "For gift ideas, I'd recommend our Premium Face Serum, Wireless Noise-Canceling Headphones, or Mystery Thriller Novels. These are very popular gift choices!";
                        }
                        
                        messagesContainer.innerHTML += `
                            <div class="flex items-start mb-4">
                                <div class="min-w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center mr-2">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div class="bg-white dark:bg-gray-700 rounded-lg py-2 px-4 shadow-sm max-w-xs">
                                    <p>${response}</p>
                                </div>
                            </div>
                        `;
                        
                        // Scroll to bottom
                        messagesContainer.scrollTop = messagesContainer.scrollHeight;
                    }, 1500);
                }
            } catch (error) {
                console.error('Error sending message to assistant:', error);
                
                // Remove loading indicator
                document.getElementById('assistantLoading').remove();
                
                // Add error message
                messagesContainer.innerHTML += `
                    <div class="flex items-start mb-4">
                        <div class="min-w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center mr-2">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-lg py-2 px-4 shadow-sm max-w-xs text-red-500">
                            <p>Sorry, there was an error getting recommendations. Please try again later.</p>
                        </div>
                    </div>
                `;
                
                // Scroll to bottom
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Check for logged in user
            checkAuthStatus();
            
            // Load products
            applyFilters();
        });
    </script>
</body>
</html>